{"version":3,"sources":["webpack://fido_timeline/./src/Ease.ts","webpack://fido_timeline/./src/Marker.ts","webpack://fido_timeline/./src/PlayMode.ts","webpack://fido_timeline/./src/Keyframe.ts","webpack://fido_timeline/./src/math.ts","webpack://fido_timeline/./src/utils.ts","webpack://fido_timeline/./src/Timeline.ts","webpack://fido_timeline/./src/layers/Layer.ts","webpack://fido_timeline/./src/layers/LayerAudio.ts","webpack://fido_timeline/./src/layers/LayerImage.ts","webpack://fido_timeline/./src/layers/LayerShape.ts","webpack://fido_timeline/./src/layers/LayerText.ts","webpack://fido_timeline/./src/layers/LayerVideo.ts","webpack://fido_timeline/./src/layers/Composition.ts","webpack://fido_timeline/./src/three/geometry/TextGeometry.ts","webpack://fido_timeline/external \"three\"","webpack://fido_timeline/./node_modules/layout-bmfont-text/index.js","webpack://fido_timeline/./node_modules/word-wrapper/index.js","webpack://fido_timeline/./node_modules/xtend/immutable.js","webpack://fido_timeline/./node_modules/as-number/index.js","webpack://fido_timeline/./node_modules/quad-indices/index.js","webpack://fido_timeline/./node_modules/dtype/index.js","webpack://fido_timeline/./node_modules/an-array/index.js","webpack://fido_timeline/./node_modules/is-buffer/index.js","webpack://fido_timeline/./src/three/geometry/ThreeLineGeometry.ts","webpack://fido_timeline/./node_modules/polyline-normals/index.js","webpack://fido_timeline/./node_modules/polyline-miter-util/index.js","webpack://fido_timeline/./node_modules/gl-vec2/add.js","webpack://fido_timeline/./node_modules/gl-vec2/set.js","webpack://fido_timeline/./node_modules/gl-vec2/normalize.js","webpack://fido_timeline/./node_modules/gl-vec2/subtract.js","webpack://fido_timeline/./node_modules/gl-vec2/dot.js","webpack://fido_timeline/./src/three/materials/StrokeMaterial.ts","webpack://fido_timeline/./src/three/glsl/layers/stroke.vert","webpack://fido_timeline/./src/three/glsl/layers/stroke.frag","webpack://fido_timeline/./src/three/materials/TextMaterial.ts","webpack://fido_timeline/./src/three/glsl/layers/font.vert","webpack://fido_timeline/./src/three/glsl/layers/font.frag","webpack://fido_timeline/./src/three/mesh/TextMesh.ts","webpack://fido_timeline/./src/three/layers/ThreeLayer.ts","webpack://fido_timeline/./src/three/utils.ts","webpack://fido_timeline/./src/three/layers/ThreeImage.ts","webpack://fido_timeline/./src/three/layers/ThreeShape.ts","webpack://fido_timeline/./src/three/layers/ThreeText.ts","webpack://fido_timeline/./src/three/layers/ThreeVideo.ts","webpack://fido_timeline/./src/three/layers/ThreeComposition.ts","webpack://fido_timeline/webpack/bootstrap","webpack://fido_timeline/webpack/runtime/compat get default export","webpack://fido_timeline/webpack/runtime/define property getters","webpack://fido_timeline/webpack/runtime/hasOwnProperty shorthand","webpack://fido_timeline/webpack/runtime/make namespace object","webpack://fido_timeline/webpack/startup"],"names":["LINEAR","BEZIER","HOLD","none","inQuad","inCubic","inQuart","inQuint","inSine","inExpo","inCirc","inBack","outQuad","outCubic","outQuart","outQuint","outSine","outExpo","outCirc","outBack","inOutQuad","inOutCubic","inOutQuart","inOutQuint","inOutSine","inOutExpo","inOutCirc","inOutBack","Marker","name","time","this","PlayMode","Keyframe","obj","opts","guid","duration","ease","easeType","props","startValues","endValues","onUpdate","undefined","object","originalEaseType","Object","keys","forEach","key","value","start","push","linearEase","sameEaseType","startTime","endTime","percent","normalize","clamp","progress","getCurve","prop","index","target","Array","isArray","total","length","values","i","mix","cubicBezier","between","TWO_PI","Math","PI","HALF_PI","min","max","map","min1","max1","min2","max2","roundTo","digits","Number","toFixed","distance","x","y","d","sqrt","distance2","x1","y1","x2","y2","d1","d2","distance3","z1","z2","d3","random","slopeFromT","t","A","B","C","xFromT","D","x0","y0","isLinear","E","F","G","current","currentx","currentslope","Infinity","H","tt","yFromT","tween","keyframes","totalKeys","delim","startKey","floor","endKey","adjusted","mixArrays","end","result","fileName","path","slash","lastIndexOf","period","substring","Date","now","round","toString","Timeline","markers","mode","playing","speed","seconds","prevSeconds","lastUpdate","keyframe","marker","getMarker","callback","resetTime","updateKeyframes","updateTime","updateMarkers","isActive","update","search","pause","delta","nextTime","abs","performance","Layer","json","assets","showing","item","fileID","file","draw","width","height","resize","timeline","animate","transform","LayerAudio","super","content","source","audio","active","paused","play","LayerImage","images","LayerShape","LayerText","LayerVideo","videos","audioEnabled","setAttribute","muted","volume","Composition","layers","camera","dispose","layer","updateLayers","l","visible","showable","playLayers","pauseLayers","parentComp","m","buildLayer","type","buildPost","buildLayerAudio","buildCamera","buildLayerComposition","buildLayerImage","buildLayerShape","buildLayerText","buildLayerVideo","build","box","computeSphere","positions","output","count","bounds","minX","minY","center","set","radius","TextGeometry","BufferGeometry","layout","glyphs","texWidth","texHeight","BufferAttribute","Float32Array","options","filter","glyph","bitmap","data","font","common","scaleW","scaleH","position","xoffset","yoffset","w","h","generatePositions","uvs","flipY","bw","bh","u0","v1","u1","v0","generateUVs","indices","clockwise","setIndex","multipage","pages","id","page","generatePages","boundingSphere","Sphere","attributes","array","posSize","itemSize","isNaN","console","error","module","exports","three","wordWrap","xtend","number","X_HEIGHTS","M_WIDTHS","CAP_HEIGHTS","TAB_ID","charCodeAt","SPACE_ID","TextLayout","opt","_measure","computeMetrics","bind","wrapper","Function","join","getGlyphById","chars","glyphIdx","findChar","getKerning","left","right","kernings","table","kern","first","second","amount","prototype","measure","_opt","tabSize","Error","text","_setupSpaceGlyphs","lines","minWidth","maxLineWidth","reduce","prev","line","lineHeight","baseline","base","descender","letterSpacing","align","getAlignType","_width","_height","_descender","_baseline","_xHeight","idx","getXHeight","_capHeight","getCapHeight","_lineHeight","_ascender","self","lineIndex","lastGlyph","lineWidth","getGlyph","tx","xadvance","_linesTotal","_fallbackSpaceGlyph","_fallbackTabGlyph","space","getMGlyph","tabWidth","curPen","curWidth","nextPen","nextWidth","defineProperty","get","configurable","newline","newlineChar","whitespace","idxOf","chr","indexOf","isWhitespace","test","monospace","MAX_VALUE","lineStart","charAt","isNewline","measured","pre","testWidth","newLine","lineEnd","nextStart","greedy","arguments","hasOwnProperty","call","num","def","dtype","anArray","isBuffer","CW","CCW","dir","a","b","c","numIndices","j","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","Float64Array","Uint8ClampedArray","str","arr","BYTES_PER_ELEMENT","buffer","constructor","readFloatLE","slice","isSlowBuffer","_isBuffer","ThreeLineGeometry","pathLength","distances","closed","normals","attrDistance","getAttribute","lastPt","point","pos","per","indexArray","positionArray","distanceArray","iTotal","dist","normalArray","miterArray","n","norm","miter","geometry","scalar","s","window","devicePixelRatio","util","lineA","lineB","tangent","addNext","out","normal","points","curNormal","last","cur","next","direction","miterLen","computeMiter","last2","cur2","next2","miterLen2","pop","add","subtract","dot","tmp","halfThick","len","StrokeMaterial","ShaderMaterial","thickness","opacity","color","diffuse","dash","Vector3","trim","uniforms","Color","vertexShader","fragmentShader","side","DoubleSide","transparent","TextMaterial","RawShaderMaterial","texture","TextMesh","Object3D","material","container","fontSize","mesh","Mesh","rotation","checkToUpdate","scale","setScalar","ThreeLayer","animation","deviceRatio","frame","from","isArr","isStr","noScale","delay","pushKeyframe","anchor","p","r","MathUtils","ani","nTotal","lastN","z","startKeyframe","endKeyframe","shape","curved","children","parent","remove","parseShader","shader","defines","definitions","replace","includes","match","o","substr","chunk","ShaderChunk","anchorGeometry","applyMatrix4","Matrix4","makeTranslation","anchorGeometryTL","computeBoundingBox","boundingBox","setBlendNormal","blending","NormalBlending","blendEquation","AddEquation","blendSrc","SrcAlphaFactor","blendDst","OneMinusSrcAlphaFactor","needsUpdate","setBlendAdd","CustomBlending","OneFactor","setBlendMultiply","DstColorFactor","setBlendScreen","OneMinusDstColorFactor","ThreeImage","imgWidth","imgHeight","textures","PlaneBufferGeometry","MeshBasicMaterial","organizeList","list","order","listOrder","orderName","ThreeShape","createShape","cLayer","paths","fill","stroke","repeater","nLayer","alpha","blend","dashes","Shape","u","angle","totalPoints","ellipse","moveTo","lineTo","cos","sin","outRadius","inRadius","vertices","inTangents","outTangents","bezierCurveTo","fillColor","fillMaterial","depthTest","ShapeGeometry","aniFill","g","strokeColor","strokeMaterial","getHex","strokeTimeline","aniStroke","gap","offset","geomPoints","getPoints","pts","group","ThreeText","txtJSON","txtTexture","txt","spacing","ThreeVideo","image","currentTime","ThreeComposition","renderer","scene","Scene","PerspectiveCamera","clock","Clock","autoFOV","effects","Map","innerWidth","innerHeight","stop","fov","updateProjectionMatrix","aspect","atan","render","setSize","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","getter","__esModule","definition","enumerable","Symbol","toStringTag"],"mappings":"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","file":"fido-three.js","sourcesContent":["/**\n * An object containing constants of CSS3 eases & ease-types.\n * Reference [Ceaser](https://matthewlein.com/tools/ceaser) for CSS3 easing\n */\nexport default {\n  LINEAR: 'linear',\n  BEZIER: 'bezier',\n  HOLD: 'hold',\n\n  none: [0.250, 0.250, 0.750, 0.750],\n\n  /// In\n  inQuad: [0.550, 0.085, 0.680, 0.530],\n  inCubic: [0.550, 0.055, 0.675, 0.190],\n  inQuart: [0.895, 0.030, 0.685, 0.220],\n  inQuint: [0.755, 0.050, 0.855, 0.060],\n  inSine: [0.470, 0.000, 0.745, 0.715],\n  inExpo: [0.950, 0.050, 0.795, 0.035],\n  inCirc: [0.600, 0.040, 0.980, 0.335],\n  inBack: [0.600, 0.000, 0.735, 0.045],\n\n  /// Out\n  outQuad: [0.250, 0.460, 0.450, 0.940],\n  outCubic: [0.215, 0.610, 0.355, 1.000],\n  outQuart: [0.165, 0.840, 0.440, 1.000],\n  outQuint: [0.230, 1.000, 0.320, 1.000],\n  outSine: [0.390, 0.575, 0.565, 1.000],\n  outExpo: [0.190, 1.000, 0.220, 1.000],\n  outCirc: [0.075, 0.820, 0.165, 1.000],\n  outBack: [0.175, 0.885, 0.320, 1.000],\n\n  /// In Out\n  inOutQuad: [0.455, 0.030, 0.515, 0.955],\n  inOutCubic: [0.645, 0.045, 0.355, 1.000],\n  inOutQuart: [0.770, 0.000, 0.175, 1.000],\n  inOutQuint: [0.860, 0.000, 0.070, 1.000],\n  inOutSine: [0.445, 0.050, 0.550, 0.950],\n  inOutExpo: [1.000, 0.000, 0.000, 1.000],\n  inOutCirc: [0.785, 0.135, 0.150, 0.860],\n  inOutBack: [0.680, 0.000, 0.265, 1.000]\n};\n","/**\n * A Marker object.\n * If the `name` param has `-stop` added, it'll trigger the\n * Timeline to stop when the Marker is first activated.\n */\nexport default class Marker {\n  name: string = '';\n\n  time: number = 0;\n\n  callback?: () => void;\n\n  constructor(name: string = '', time: number = 0) {\n    this.name = name;\n    this.time = time;\n  }\n}\n","/**\n * How the Timeline should play.\n */\nenum PlayMode {\n  Loop = 'Loop',\n  Once = 'Once',\n  PingPong = 'PingPong'\n}\n\nexport default PlayMode;\n","import {\n  between,\n  clamp,\n  cubicBezier,\n  mix,\n  normalize\n} from './math';\nimport { guid } from './utils';\nimport Ease from './Ease';\n\n/**\n * An object that tweens from 1 value to another with Cubic-Bezier easing.\n */\nexport default class Keyframe {\n  name: string = guid();\n\n  /**\n   * The start time (in seconds).\n   */\n  time: number = 0;\n\n  /**\n   * The duration of the animation (in seconds).\n   */\n  duration: number = 0;\n\n  /**\n   * Based on Cubic-Bezier\n   */\n  ease: Array<number> = Ease.none;\n\n  /**\n   * One of these 3:\n   * ```typescript\n   * Ease.LINEAR\n   * Ease.BEZIER\n   * Ease.HOLD\n   * ```\n   */\n  easeType: string = Ease.BEZIER;\n\n  // Object\n\n  /**\n   * The object to animate.\n   */\n  object: any;\n\n  /**\n   * The name of the variables that are animating.\n   */\n  props: Array<string> = [];\n\n  /**\n   * Where things start.\n   */\n  startValues: Array<any> = [];\n\n  /**\n   * Where things end.\n   */\n  endValues: Array<any> = [];\n\n  /**\n   * An optional callback\n   */\n  onUpdate?: (progress: number) => void = undefined;\n\n  /**\n   * Creates a Keyframe\n   * @param obj The object to animate\n   * @param opts An object containing animation variables\n   */\n  constructor(obj: any, opts: any) {\n    this.object = obj;\n\n    const originalEaseType = this.easeType;\n    Object.keys(opts).forEach((key: string) => {\n      const value = opts[key];\n      if (key === 'name') {\n        this.name = value;\n      } else if (key === 'delay') {\n        this.time = value;\n      } else if (key === 'duration') {\n        this.duration = value;\n      } else if (key === 'ease') {\n        this.ease = value;\n      } else if (key === 'type') {\n        this.easeType = value;\n      } else if (key === 'onUpdate') {\n        this.onUpdate = value;\n      } else if (key !== 'start') {\n        let start = this.object[key];\n        if (opts.start !== undefined) {\n          start = opts.start[key];\n        }\n        this.props.push(key);\n        this.startValues.push(start);\n        this.endValues.push(value);\n      }\n    });\n\n    const linearEase = this.ease[0] === this.ease[1] && this.ease[2] === this.ease[3];\n    const sameEaseType = originalEaseType === this.easeType;\n    if (linearEase && sameEaseType) {\n      this.easeType = Ease.LINEAR;\n    }\n  }\n\n  /**\n   * Updates our object based on the time\n   * @param time Clamps the value between your start and end times.\n   */\n  update(time: number): void {\n    const startTime = this.time;\n    const { endTime } = this;\n    const percent = normalize(startTime, endTime, clamp(startTime, endTime, time));\n    const progress = clamp(0, 1, this.getCurve(percent));\n\n    this.props.forEach((prop: string, index: number) => {\n      const start = this.startValues[index];\n      const target = this.endValues[index];\n      if (Array.isArray(start)) {\n        const total = start.length;\n        const values: Array<number> = [];\n        for (let i = 0; i < total; ++i) {\n          values.push(mix(start[i], target[i], progress));\n        }\n        this.object[prop] = values;\n      } else if (typeof start === 'string' || typeof start === 'boolean') {\n        this.object[prop] = progress < 1 ? start : target;\n      } else {\n        this.object[prop] = mix(start, target, progress);\n      }\n    });\n\n    if (this.onUpdate !== undefined) this.onUpdate(progress);\n  }\n\n  /**\n   * Converts a linear percentage to your eased value.\n   * @param percent Ranging from 0 to 1.\n   */\n  getCurve(percent: number): number {\n    if (this.easeType === Ease.BEZIER) {\n      return cubicBezier(percent, this.ease[0], this.ease[1], this.ease[2], this.ease[3]);\n      // eslint-disable-next-line\n    } else if (this.easeType === Ease.HOLD) {\n      return percent < 1 ? 0 : 1;\n    }\n    return percent;\n  }\n\n  /**\n   * If the Keyframe is active during the given time\n   * @param time Usually the time given from the Timeline\n   */\n  isActive(time: number): boolean {\n    return between(this.time, this.time + this.duration, time);\n  }\n\n  get startTime() {\n    return this.time;\n  }\n\n  get endTime() {\n    return this.time + this.duration;\n  }\n}\n","export const TWO_PI: number = Math.PI * 2;\nexport const HALF_PI: number = Math.PI / 2;\n\nexport function between(min: number, max: number, value: number) {\n  return value >= min && value <= max;\n}\n\nexport function normalize(min: number, max: number, value: number) {\n  return (value - min) / (max - min);\n}\n\nexport function mix(min: number, max: number, value: number) {\n  return min * (1 - value) + max * value;\n}\n\nexport function map(min1: number, max1: number, min2: number, max2: number, value: number) {\n  return mix(min2, max2, normalize(min1, max1, value));\n}\n\nexport function clamp(min: number, max: number, value: number) {\n  return Math.min(max, Math.max(min, value));\n}\n\nexport function roundTo(value: number, digits: number = 1): number {\n  return Number(value.toFixed(digits));\n}\n\nexport function distance(x: number, y: number): number {\n  const d = x - y;\n  return Math.sqrt(d * d);\n}\n\nexport function distance2(x1: number, y1: number, x2: number, y2: number): number {\n  const d1 = x1 - x2;\n  const d2 = y1 - y2;\n  return Math.sqrt(d1 * d1 + d2 * d2);\n}\n\nexport function distance3(\n  x1: number, y1: number, z1: number,\n  x2: number, y2: number, z2: number\n): number {\n  const d1 = x1 - x2;\n  const d2 = y1 - y2;\n  const d3 = z1 - z2;\n  return Math.sqrt(d1 * d1 + d2 * d2 + d3 * d3);\n}\n\nexport function random(min: number, max: number) {\n  return mix(min, max, Math.random());\n}\n\n// Bezier\n\nfunction isLinear(x0: number, y0: number, x1: number, y1: number): boolean {\n  return x0 === y0 && x1 === y1;\n}\n\nfunction slopeFromT(t: number, A: number, B: number, C: number): number {\n  return 1.0 / (3.0 * A * t * t + 2.0 * B * t + C);\n}\n\nfunction xFromT(t: number, A: number, B: number, C: number, D: number): number {\n  return A * (t * t * t) + B * (t * t) + C * t + D;\n}\n\nfunction yFromT(t: number, E: number, F: number, G: number, H: number): number {\n  const tt = t * t;\n  return E * (tt * t) + F * tt + G * t + H;\n}\n\nexport function cubicBezier(percent: number, x0: number, y0: number, x1: number, y1: number): number {\n  if (percent <= 0) return 0;\n  if (percent >= 1) return 1;\n  if (isLinear(x0, y0, x1, y1)) return percent; // linear\n\n  const x0a = 0; // initial x\n  const y0a = 0; // initial y\n  const x1a = x0; // 1st influence x\n  const y1a = y0; // 1st influence y\n  const x2a = x1; // 2nd influence x\n  const y2a = y1; // 2nd influence y\n  const x3a = 1; // final x\n  const y3a = 1; // final y\n\n  const A = x3a - 3.0 * x2a + 3.0 * x1a - x0a;\n  const B = 3.0 * x2a - 6.0 * x1a + 3.0 * x0a;\n  const C = 3.0 * x1a - 3.0 * x0a;\n  const D = x0a;\n\n  const E = y3a - 3.0 * y2a + 3.0 * y1a - y0a;\n  const F = 3.0 * y2a - 6.0 * y1a + 3.0 * y0a;\n  const G = 3.0 * y1a - 3.0 * y0a;\n  const H = y0a;\n\n  let current = percent;\n  for (let i = 0; i < 5; i++) {\n    const currentx = xFromT(current, A, B, C, D);\n    let currentslope = slopeFromT(current, A, B, C);\n    if (currentslope === Infinity) currentslope = percent;\n    current -= (currentx - percent) * (currentslope);\n    current = Math.min(Math.max(current, 0.0), 1.0);\n  }\n\n  return yFromT(current, E, F, G, H);\n}\n\n/**\n * Animates a set of keyframe values\n * @param  {Number} time Ranging from 0 - 1\n * @param  {Array} keyframes Set of key values, ie: [ 0, 50, 25, 50, 100 ]\n * @return {Number} The linearly interpolated value between keyframes,\n * ie: tween(0.25, [ 0, 50, 25, 50, 100 ]) returns 50\n */\nexport function tween(value: number, keyframes: Array<number>) {\n  const totalKeys = keyframes.length - 1;\n  if (totalKeys === 0) return keyframes[0];\n  const delim = 1 / totalKeys;\n  const startKey = Math.min(Math.floor(value * totalKeys), totalKeys - 1);\n  const endKey = startKey + 1;\n  const startTime = startKey * delim;\n  const endTime = endKey * delim;\n  const adjusted = normalize(startTime, endTime, value);\n  return mix(keyframes[startKey], keyframes[endKey], adjusted);\n}\n\n/**\n * Tweens between 2 sets of arrays\n */\nexport function mixArrays(start: Array<number>, end: Array<number>, value: number): Array<number> {\n  const result: Array<number> = [];\n  const total = start.length;\n  for (let i = 0; i < total; ++i) {\n    result.push(mix(start[i], end[i], value));\n  }\n  return result;\n}\n","export function fileName(path: string): string {\n  const slash = path.lastIndexOf('/') + 1;\n  const period = path.lastIndexOf('.');\n  return path.substring(slash, period);\n}\n\nexport function guid() {\n  return (Date.now() + Math.round(Math.random() * 99999)).toString();\n}\n","import { between } from './math';\nimport Keyframe from './Keyframe';\nimport Marker from './Marker';\nimport PlayMode from './PlayMode';\n\n/**\n * Based on the After Effects Timeline and inspired by Flash's, the Timeline\n * can animate multiple objects with time-scaling.\n */\nexport default class Timeline {\n  /**\n   * The amount of time in seconds.\n   */\n  duration: number = 0;\n\n  /**\n   * A list of the Keyframes.\n   */\n  keyframes: Array<Keyframe> = [];\n\n  /**\n   * A list of the Markers.\n   */\n  markers: Array<Marker> = [];\n\n  /**\n   * How the Timeline should play.\n   */\n  mode: PlayMode = PlayMode.Loop;\n\n  /**\n   * If the Timeline is playing.\n   */\n  playing: boolean = true;\n\n  /**\n   * How quickly the time should be multiplied. Default = 1.\n   */\n  speed: number = 1;\n\n  /**\n   * An object to manage time.\n   */\n  time = {\n    seconds: 0,\n    prevSeconds: 0,\n    lastUpdate: 0\n  };\n\n  /**\n   * Creates a Timeline with optional paramaeters.\n   * @param opts Params include `duration`, `mode`, `playing`, `speed`.\n   */\n  constructor(opts?: any) {\n    if (opts !== undefined) {\n      if (opts.mode !== undefined) this.mode = opts.mode;\n      if (opts.duration !== undefined) this.duration = opts.duration;\n      if (opts.playing !== undefined) this.playing = opts.playing;\n      if (opts.speed !== undefined) this.speed = opts.speed;\n    }\n  }\n\n  /**\n   * Clears the Keyframes and Markers.\n   */\n  dispose() {\n    this.keyframes = [];\n    this.markers = [];\n  }\n\n  /**\n   * Creates a Keyframe.\n   * @param obj The object to reference.\n   * @param opts The Keyframe paramaeters.\n   */\n  addKeyframe(obj: any, opts: any) {\n    this.keyframes.push(new Keyframe(obj, opts));\n  }\n\n  /**\n   * Creates a Marker.\n   * @param name The Marker name.\n   * @param time The Marker time.\n   */\n  addMarker(name: string = '', time: number = 0) {\n    this.markers.push(new Marker(name, time));\n  }\n\n  /**\n   * Pushes a Keyframe to the array.\n   * @param keyframe A precreated Keyframe.\n   */\n  pushKeyframe(keyframe: Keyframe) {\n    this.keyframes.push(keyframe);\n  }\n\n  /**\n   * Retrieves the Marker by name.\n   * @param name The name of the Marker.\n   */\n  getMarker(name: string): Marker | undefined {\n    const total = this.markers.length;\n    for (let i = 0; i < total; ++i) {\n      const marker = this.markers[i];\n      if (marker.name === name) {\n        return marker;\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Changes the Timeline to the Marker time.\n   * @param name The name of the Marker.\n   */\n  goToMarker(name: string) {\n    const marker = this.getMarker(name);\n    if (marker !== undefined) {\n      this.seconds = marker.time;\n      if (marker.callback !== undefined) {\n        marker.callback();\n      }\n    }\n  }\n\n  /**\n   * Plays the Timeline.\n   */\n  play() {\n    this.playing = true;\n    this.resetTime();\n  }\n\n  /**\n   * Pauses the Timeline.\n   */\n  pause() {\n    this.playing = false;\n  }\n\n  /**\n   * Updates the Timeline animation.\n   * @param time Sets the time of the Timeline.\n   */\n  update(time?: number) {\n    if (!this.playing) return;\n    if (time !== undefined) this.time.seconds = time;\n    this.updateKeyframes();\n    this.updateTime();\n    this.updateMarkers();\n  }\n\n  /**\n   * Updates the Keyframes individually.\n   */\n  updateKeyframes() {\n    this.keyframes.forEach((keyframe: Keyframe) => {\n      if (keyframe.isActive(this.seconds)) {\n        keyframe.update(this.seconds);\n      }\n    });\n  }\n\n  /**\n   * Updates the Markers individually.\n   */\n  updateMarkers() {\n    const total = this.markers.length;\n    for (let i = 0; i < total; ++i) {\n      const marker = this.markers[i];\n      const isActive = between(this.time.prevSeconds, this.time.seconds, marker.time);\n      if (isActive) {\n        if (marker.callback !== undefined) {\n          marker.callback();\n        }\n        if (marker.name.search('-stop') > 0) {\n          this.pause();\n          this.seconds = marker.time;\n        }\n        return;\n      }\n    }\n  }\n\n  /**\n   * Updates the time based on the `playMode`.\n   */\n  updateTime() {\n    const { now } = this;\n    const delta = (now - this.time.lastUpdate) / 1000;\n    const nextTime = this.time.seconds + (delta * this.speed);\n    this.time.lastUpdate = now;\n    this.time.prevSeconds = this.time.seconds;\n    this.time.seconds = nextTime;\n\n    if (this.duration > 0 && this.time.seconds >= this.duration) {\n      switch (this.mode) {\n        default:\n        case PlayMode.Loop:\n          this.time.seconds = 0;\n          break;\n        case PlayMode.Once:\n          this.time.seconds = this.duration;\n          this.playing = false;\n          break;\n        case PlayMode.PingPong:\n          this.time.seconds = this.duration - delta;\n          this.speed = -Math.abs(this.speed);\n          break;\n      }\n    }\n\n    // Reverse Ping-Pong to play forward\n    if (this.time.seconds < 0 && this.mode === PlayMode.PingPong) {\n      this.time.seconds = 0;\n      this.speed = Math.abs(this.speed);\n    }\n  }\n\n  /**\n   * Resets the time so there isn't a big time-jump.\n   */\n  resetTime() {\n    this.time.lastUpdate = this.now;\n  }\n\n  get now(): number {\n    return (performance || Date).now();\n  }\n\n  get seconds(): number {\n    return this.time.seconds;\n  }\n\n  set seconds(value: number) {\n    this.time.seconds = value;\n  }\n}\n","import Timeline from '../Timeline';\n\n/**\n * An After Effects layer.\n */\nexport default class Layer {\n  /**\n   * The name of the layer (should be unique).\n   */\n  name: string = '';\n\n  /**\n   * The time the layer begins.\n   */\n  start: number = 0;\n\n  /**\n   * The duration the layer exists on the Timeline.\n   */\n  duration: number = 0;\n\n  /**\n   * If the layer is currently visible (in time).\n   */\n  showing: boolean = true;\n\n  /**\n   * An object used when extending this class.\n   */\n  item: any = undefined;\n\n  /**\n   * If the layer has a file associated to it (audio/image/video/etc),\n   * this should be the file name.\n   */\n  fileID: string = ''; // to reclaim from loader\n\n  /**\n   * If the layer has a file associated to it (audio/image/video/etc),\n   * this should be the file.\n   */\n  file: any = undefined; // actual loaded asset\n\n  /**\n   * Creates a new layer based on the JSON data.\n   * @param json The JSON data of the layer.\n   * @param assets The loaded assets.\n   */\n  constructor(json: any, assets: any) {\n    this.name = json.name !== undefined ? json.name : '';\n    this.start = json.start !== undefined ? json.start : 0; // start time\n    this.duration = json.duration !== undefined ? json.duration : 0; // duration the layer is in comp\n    this.showing = json.showing !== undefined ? json.showing : true;\n  }\n\n  /**\n   * Clears all memory of the layer.\n   */\n  dispose() {\n    //\n  }\n\n  /**\n   * Updates the item and any other animation paramaters needed.\n   * @param time The time of the composition.\n   * @param duration The duration of the composition.\n   */\n  update(time?: number, duration?: number) {\n    if (this.item !== undefined && this.item.update !== undefined) {\n      this.item.update(time, duration !== undefined ? duration : this.duration);\n    }\n  }\n\n  /**\n   * Renders the layer.\n   */\n  draw() {\n    if (this.item !== undefined && this.item.draw !== undefined) {\n      this.item.draw();\n    }\n  }\n\n  /**\n   * Resizes the layer to the size of the composition.\n   * @param width The composition width.\n   * @param height The composition height.\n   */\n  resize(width: number, height: number) {\n    if (this.item !== undefined && this.item.resize !== undefined) {\n      this.item.resize(width, height);\n    }\n  }\n\n  /**\n   * Animates unique variables, like shape data.\n   * @param json The JSON data.\n   * @param timeline The composition timeline.\n   */\n  animate(json: any, timeline: Timeline) {\n    if (this.item !== undefined && this.item.animate !== undefined) {\n      this.item.animate(json, timeline);\n    }\n  }\n\n  /**\n   * Animates the transform object.\n   * @param json The JSON data\n   * @param timeline The composition timeline.\n   */\n  transform(json: any, timeline: Timeline) {\n    if (this.item !== undefined && this.item.transform !== undefined) {\n      this.item.transform(json, timeline);\n    }\n  }\n\n  /**\n   * Checks if the layer is currently viewable based on the given time.\n   * @param time The time of the composition.\n   */\n  showable(time: number): boolean {\n    const endTime = this.start + this.duration;\n    return (this.duration > 0) ? (time >= this.start && time <= endTime) : true;\n  }\n}\n","import Layer from './Layer';\nimport { between } from '../math';\nimport { fileName } from '../utils';\n\n/**\n * An audio object.\n */\nexport default class LayerAudio extends Layer {\n  constructor(json: any, assets: any) {\n    super(json, assets);\n\n    this.fileID = fileName(json.content.value.source);\n    this.file = assets.audio[this.fileID] as HTMLAudioElement;\n  }\n\n  dispose() {\n    this.file.pause();\n  }\n\n  update(time: number, duration: number) {\n    const startTime = this.start;\n    const endTime = this.start + this.file.duration;\n    const active = between(startTime, endTime, time);\n    if (this.file.paused && active) {\n      this.file.play();\n    }\n  }\n}\n","import Layer from './Layer';\nimport { fileName } from '../utils';\n\n/**\n * An image elment.\n */\nexport default class LayerImage extends Layer {\n  constructor(json: any, assets: any) {\n    super(json, assets);\n\n    this.fileID = fileName(json.content.source);\n    this.file = assets.images[this.fileID] as HTMLImageElement;\n  }\n}\n","import Layer from './Layer';\n\n/**\n * An animatable shape.\n */\nexport default class LayerShape extends Layer {\n}\n","import Layer from './Layer';\n\n/**\n * Animatable text.\n */\nexport default class LayerText extends Layer {\n}\n","import Layer from './Layer';\nimport { fileName } from '../utils';\n\n/**\n * A video element.\n */\nexport default class LayerVideo extends Layer {\n  constructor(json: any, assets: any) {\n    super(json, assets);\n\n    this.fileID = fileName(json.content.source);\n    this.file = assets.videos[this.fileID] as HTMLVideoElement;\n    if (!json.content.audioEnabled) {\n      this.file.setAttribute('muted', 'true');\n      this.file.muted = false;\n      this.file.volume = 0;\n    }\n  }\n\n  dispose() {\n    this.file.pause();\n  }\n}\n","import Layer from './Layer';\nimport Marker from '../Marker';\nimport PlayMode from '../PlayMode';\nimport Timeline from '../Timeline';\nimport LayerAudio from './LayerAudio';\nimport LayerImage from './LayerImage';\nimport LayerShape from './LayerShape';\nimport LayerText from './LayerText';\nimport LayerVideo from './LayerVideo';\n\n/**\n * An After Effects composition.\n */\nexport default class Composition extends Layer {\n  /**\n   * The width of the composition.\n   */\n  width: number = 0;\n\n  /**\n   * The height of the composition.\n   */\n  height: number = 0;\n\n  /**\n   * The layers of the composition.\n   */\n  layers: Array<Layer> = [];\n\n  /**\n   * The Timeline to animate to.\n   */\n  timeline: Timeline = new Timeline({});\n\n  /**\n   * The Composition's camera, if it has one.\n   */\n  camera: any = undefined;\n\n  /**\n   * Creates a Composition & all the layers.\n   * @param json The Composition JSON data.\n   * @param assets The loaded assets.\n   */\n  constructor(json: any, assets: any) {\n    super(json, assets);\n    this.width = json.width;\n    this.height = json.height;\n    this.timeline.duration = json.duration;\n    this.showing = this.start === 0;\n  }\n\n  /**\n   * Disposes the Composition and all the layers.\n   */\n  dispose() {\n    this.timeline.dispose();\n    this.camera = undefined;\n    this.layers.forEach((layer: Layer) => {\n      layer.dispose();\n    });\n    this.layers = [];\n  }\n\n  /**\n   * Adds a Layer to the end of the Layer stack.\n   * @param layer Any type of Layer\n   */\n  addLayer(layer: Layer) {\n    layer.showing = this.start === 0 && layer.start === 0;\n    this.layers.push(layer);\n  }\n\n  /**\n   * Animates the viewable Layers.\n   * @param time The time of an optional parent Composition.\n   * @param duration The duration of an optional parent Composition.\n   */\n  update(time?: number, duration?: number) {\n    const d = duration !== undefined ? duration : this.timeline.duration;\n    this.timeline.duration = d;\n    this.timeline.update(time);\n    this.updateLayers(this.timeline.seconds, d);\n  }\n\n  /**\n   * Checks if the Layers are viewable & updates them.\n   * @param time The time of the Composition.\n   * @param duration The duration of the Composition.\n   */\n  updateLayers(time: number, duration: number) {\n    const total = this.layers.length;\n    for (let i = 0; i < total; ++i) {\n      const l = this.layers[i];\n      const visible = l.showable(time);\n      if (visible) {\n        if (l instanceof Composition) {\n          if (!l.showing) {\n            l.play();\n          }\n          l.update(time, duration);\n        } else {\n          l.update(time, duration);\n        }\n      } else if (l.showing && l instanceof Composition) {\n        if (l.timeline.playing && l.timeline.seconds > 0) {\n          l.timeline.seconds = l.timeline.duration;\n\n          if (l.timeline.speed < 0) {\n            l.timeline.seconds = 0;\n          }\n        }\n      }\n      l.showing = visible;\n    }\n  }\n\n  /**\n   * Renders the viewable Layers.\n   */\n  draw() {\n    const time = this.seconds;\n    const total = this.layers.length;\n    for (let i = 0; i < total; ++i) {\n      const l = this.layers[i];\n      const visible = l.showable(time);\n      if (visible) l.draw();\n    }\n  }\n\n  /**\n   * Plays the Timeline.\n   */\n  play() {\n    this.timeline.play();\n    this.playLayers();\n  }\n\n  /**\n   * Pauses the Timeline.\n   */\n  pause() {\n    this.timeline.pause();\n    this.pauseLayers();\n  }\n\n  /**\n   * @ignore\n   */\n  playLayers() {\n    const time = this.seconds;\n    const total = this.layers.length;\n    for (let i = 0; i < total; ++i) {\n      const layer = this.layers[i];\n      if (layer instanceof Composition && layer.showable(time)) {\n        layer.play();\n      }\n    }\n  }\n\n  /**\n   * @ignore\n   */\n  pauseLayers() {\n    const total = this.layers.length;\n    for (let i = 0; i < total; ++i) {\n      const layer = this.layers[i];\n      if (layer instanceof Composition && layer.playing) {\n        layer.pause();\n      }\n    }\n  }\n\n  /**\n   * Resizes all the Layers, but does not reset the size of the Composition.\n   * @param width Generally the view width.\n   * @param height Generally the view height.\n   */\n  resize(width: number, height: number) {\n    this.layers.forEach((layer: Layer) => {\n      layer.resize(width, height);\n    });\n  }\n\n  // Build\n\n  /**\n   * Creates all the Layers based on the JSON data.\n   * @param json The Composition JSON data.\n   * @param assets The loaded assets.\n   * @param parentComp An optional parent Composition to limit the timeline to.\n   */\n  build(json: any, assets: any, parentComp?: Composition) {\n    this.name = json.name;\n    this.width = json.width;\n    this.height = json.height;\n    if (parentComp !== undefined) {\n      this.duration = Math.min(this.duration, parentComp.duration);\n      this.timeline.duration = this.duration;\n    }\n\n    // Build markers\n    let total = json.markers.length;\n    for (let i = 0; i < total; ++i) {\n      const m = json.markers[i];\n      this.timeline.markers.push(new Marker(m.name, m.time));\n    }\n\n    // Build layers\n    total = json.layers.length;\n    for (let i = total - 1; i > -1; --i) {\n      const layer = this.buildLayer(json, assets, json.layers[i]);\n      if (layer !== undefined) this.layers.push(layer);\n    }\n  }\n\n  /**\n   * Checks the Layer type and creates a new Layer based on it.\n   * @param json The Composition JSON data.\n   * @param assets The loaded assets.\n   * @param item The Layer JSON data.\n   */\n  buildLayer(json: any, assets: any, item: any): Layer | undefined {\n    let layer: Layer | undefined;\n\n    // Create layer...\n    switch (item.type) {\n      case 'adjustment':\n        if (item.name === 'post') {\n          this.buildPost(item);\n        }\n        break;\n      case 'audio':\n        layer = this.buildLayerAudio(json, item, assets);\n        break;\n      case 'camera':\n        this.buildCamera(item);\n        break;\n      case 'composition':\n        layer = this.buildLayerComposition(json, item, assets);\n        break;\n      default:\n      case 'image':\n        layer = this.buildLayerImage(json, item, assets);\n        break;\n      case 'shape':\n        layer = this.buildLayerShape(json, item, assets);\n        break;\n      case 'text':\n        layer = this.buildLayerText(json, item, assets);\n        break;\n      case 'video':\n        layer = this.buildLayerVideo(json, item, assets);\n        break;\n    }\n\n    if (layer !== undefined) {\n      layer.duration = Math.min(this.timeline.duration, item.duration);\n    }\n\n    return layer;\n  }\n\n  /**\n   * Creates an Audio-based Layer.\n   * @param json The Composition JSON data.\n   * @param item The Layer JSON data.\n   * @param assets The loaded assets.\n   */\n  buildLayerAudio(json: any, item: any, assets: any) {\n    const layer = new LayerAudio(item, assets);\n    return layer;\n  }\n\n  /**\n   * Creates a Camera object.\n   * @param item The Layer JSON data.\n   */\n  buildCamera(item: any) {\n    //\n  }\n\n  /**\n   * Creates a Composition-based Layer.\n   * @param json The Composition JSON data.\n   * @param item The Layer JSON data.\n   * @param assets The loaded assets.\n   */\n  buildLayerComposition(json: any, item: any, assets: any): Composition {\n    const layer = new Composition(item, assets);\n    layer.build(json, item, this);\n    return layer;\n  }\n\n  /**\n   * Creates an Image-based Layer.\n   * @param json The Composition JSON data.\n   * @param item The Layer JSON data.\n   * @param assets The loaded assets.\n   */\n  buildLayerImage(json: any, item: any, assets: any): Layer {\n    const layer = new LayerImage(item, assets);\n    return layer;\n  }\n\n  /**\n   * Creates a Shape-based Layer.\n   * @param json The Composition JSON data.\n   * @param item The Layer JSON data.\n   * @param assets The loaded assets.\n   */\n  buildLayerShape(json: any, item: any, assets: any) {\n    const layer = new LayerShape(item, assets);\n    return layer;\n  }\n\n  /**\n   * Creates a Text-based Layer.\n   * @param json The Composition JSON data.\n   * @param item The Layer JSON data.\n   * @param assets The loaded assets.\n   */\n  buildLayerText(json: any, item: any, assets: any): Layer {\n    const layer = new LayerText(item, assets);\n    return layer;\n  }\n\n  /**\n   * Creates a Video-based Layer.\n   * @param json The Composition JSON data.\n   * @param item The Layer JSON data.\n   * @param assets The loaded assets.\n   */\n  buildLayerVideo(json: any, item: any, assets: any): Layer {\n    const layer = new LayerVideo(item, assets);\n    return layer;\n  }\n\n  /**\n   * Applies Post-Effects to the Composition\n   * @param json The Composition JSON data.\n   */\n  buildPost(json: any) {\n    //\n  }\n\n  // Getters / Setters\n\n  get playing() {\n    return this.timeline.playing;\n  }\n\n  get playMode(): PlayMode {\n    return this.timeline.mode;\n  }\n\n  get seconds() {\n    return this.timeline.seconds;\n  }\n\n  set playMode(value: PlayMode) {\n    this.timeline.mode = value;\n  }\n\n  set seconds(value: number) {\n    this.timeline.seconds = value;\n  }\n}\n","import {\n  BufferAttribute,\n  BufferGeometry,\n  Sphere\n} from 'three';\nimport createLayout from 'layout-bmfont-text';\nimport createIndices from 'quad-indices';\n\nconst itemSize = 2;\nconst box = {\n  min: [0, 0],\n  max: [0, 0]\n};\n\nfunction bounds(positions: Array<number>) {\n  const count = positions.length / itemSize;\n  // eslint-disable-next-line\n  box.min[0] = positions[0];\n  // eslint-disable-next-line\n  box.min[1] = positions[1];\n  // eslint-disable-next-line\n  box.max[0] = positions[0];\n  // eslint-disable-next-line\n  box.max[1] = positions[1];\n\n  for (let i = 0; i < count; i++) {\n    const x = positions[i * itemSize + 0];\n    const y = positions[i * itemSize + 1];\n    box.min[0] = Math.min(x, box.min[0]);\n    box.min[1] = Math.min(y, box.min[1]);\n    box.max[0] = Math.max(x, box.max[0]);\n    box.max[1] = Math.max(y, box.max[1]);\n  }\n}\n\nfunction computeSphere(positions: Array<number>, output: Sphere) {\n  bounds(positions);\n  const minX = box.min[0];\n  const minY = box.min[1];\n  const maxX = box.max[0];\n  const maxY = box.max[1];\n  const width = maxX - minX;\n  const height = maxY - minY;\n  const length = Math.sqrt(width * width + height * height);\n  output.center.set(minX + width / 2, minY + height / 2, 0);\n  output.radius = length / 2;\n}\n\nfunction generatePages(glyphs: Array<any>): Float32Array {\n  const pages = new Float32Array(glyphs.length * 4 * 1);\n  let i = 0;\n\n  glyphs.forEach((glyph: any) => {\n    const id = glyph.data.page || 0;\n    pages[i++] = id;\n    pages[i++] = id;\n    pages[i++] = id;\n    pages[i++] = id;\n  });\n\n  return pages;\n}\n\nfunction generatePositions(glyphs: Array<any>): Float32Array {\n  const positions = new Float32Array(glyphs.length * 4 * 2);\n  let i = 0;\n\n  glyphs.forEach((glyph: any) => {\n    const bitmap = glyph.data;\n\n    // bottom left position\n    const x = glyph.position[0] + bitmap.xoffset;\n    const y = glyph.position[1] + bitmap.yoffset;\n\n    // quad size\n    const w = bitmap.width;\n    const h = bitmap.height;\n\n    // BL\n    positions[i++] = x;\n    positions[i++] = y;\n    // TL\n    positions[i++] = x;\n    positions[i++] = y + h;\n    // TR\n    positions[i++] = x + w;\n    positions[i++] = y + h;\n    // BR\n    positions[i++] = x + w;\n    positions[i++] = y;\n  });\n\n  return positions;\n}\n\nfunction generateUVs(\n  glyphs: Array<any>,\n  texWidth: number,\n  texHeight: number,\n  flipY: boolean = true\n): Float32Array {\n  const uvs = new Float32Array(glyphs.length * 4 * 2);\n  let i = 0;\n\n  glyphs.forEach((glyph: any) => {\n    const bitmap = glyph.data;\n    const bw = (bitmap.x + bitmap.width);\n    const bh = (bitmap.y + bitmap.height);\n\n    // top left position\n    const u0 = bitmap.x / texWidth;\n    let v1 = bitmap.y / texHeight;\n    const u1 = bw / texWidth;\n    let v0 = bh / texHeight;\n\n    if (flipY) {\n      v1 = (texHeight - bitmap.y) / texHeight;\n      v0 = (texHeight - bh) / texHeight;\n    }\n\n    // BL\n    uvs[i++] = u0;\n    uvs[i++] = v1;\n    // TL\n    uvs[i++] = u0;\n    uvs[i++] = v0;\n    // TR\n    uvs[i++] = u1;\n    uvs[i++] = v0;\n    // BR\n    uvs[i++] = u1;\n    uvs[i++] = v1;\n  });\n\n  return uvs;\n}\n\nexport default class TextGeometry extends BufferGeometry {\n  layout: any = undefined;\n\n  glyphs: any = undefined;\n\n  texWidth: number = 0;\n\n  texHeight: number = 0;\n\n  constructor() {\n    super();\n    this.setAttribute('position', new BufferAttribute(new Float32Array([]), 2));\n  }\n\n  update(options: any) {\n    this.layout = createLayout(options);\n\n    this.glyphs = this.layout.glyphs.filter((glyph: any) => {\n      const bitmap = glyph.data;\n      return bitmap.width * bitmap.height > 0;\n    });\n\n    this.texWidth = options.font.common.scaleW;\n    this.texHeight = options.font.common.scaleH;\n\n    const positions = generatePositions(this.glyphs);\n    const uvs = generateUVs(this.glyphs, this.texWidth, this.texHeight, options.flipY);\n    const indices = createIndices([], {\n      clockwise: true,\n      type: 'uint16',\n      count: this.glyphs.length\n    });\n\n    this.setIndex(indices);\n    this.setAttribute('position', new BufferAttribute(positions, 2));\n    this.setAttribute('uv', new BufferAttribute(uvs, 2));\n\n    // update multipage data\n    if (options.multipage) {\n      // enable multipage rendering\n      const pages = generatePages(this.glyphs);\n      this.setAttribute('page', new BufferAttribute(pages, 1));\n    }\n  }\n\n  updateCopy() {\n    //\n  }\n\n  computeBoundingSphere() {\n    if (this.boundingSphere === null) {\n      this.boundingSphere = new Sphere();\n    }\n\n    const positions = this.attributes.position.array;\n    const posSize = this.attributes.position.itemSize;\n    if (!positions || !posSize || positions.length < 2) {\n      this.boundingSphere.radius = 0;\n      this.boundingSphere.center.set(0, 0, 0);\n      return;\n    }\n\n    // @ts-ignore\n    computeSphere(positions, this.boundingSphere);\n\n    if (Number.isNaN(this.boundingSphere.radius)) {\n      // eslint-disable-next-line\n      console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN');\n    }\n  }\n}\n","module.exports = three;","var wordWrap = require('word-wrapper')\nvar xtend = require('xtend')\nvar number = require('as-number')\n\nvar X_HEIGHTS = ['x', 'e', 'a', 'o', 'n', 's', 'r', 'c', 'u', 'm', 'v', 'w', 'z']\nvar M_WIDTHS = ['m', 'w']\nvar CAP_HEIGHTS = ['H', 'I', 'N', 'E', 'F', 'K', 'L', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']\n\n\nvar TAB_ID = '\\t'.charCodeAt(0)\nvar SPACE_ID = ' '.charCodeAt(0)\nvar ALIGN_LEFT = 0, \n    ALIGN_CENTER = 1, \n    ALIGN_RIGHT = 2\n\nmodule.exports = function createLayout(opt) {\n  return new TextLayout(opt)\n}\n\nfunction TextLayout(opt) {\n  this.glyphs = []\n  this._measure = this.computeMetrics.bind(this)\n  this.update(opt)\n}\n\nTextLayout.prototype.update = function(opt) {\n  opt = xtend({\n    measure: this._measure\n  }, opt)\n  this._opt = opt\n  this._opt.tabSize = number(this._opt.tabSize, 4)\n\n  if (!opt.font)\n    throw new Error('must provide a valid bitmap font')\n\n  var glyphs = this.glyphs\n  var text = opt.text||'' \n  var font = opt.font\n  this._setupSpaceGlyphs(font)\n  \n  var lines = wordWrap.lines(text, opt)\n  var minWidth = opt.width || 0\n\n  //clear glyphs\n  glyphs.length = 0\n\n  //get max line width\n  var maxLineWidth = lines.reduce(function(prev, line) {\n    return Math.max(prev, line.width, minWidth)\n  }, 0)\n\n  //the pen position\n  var x = 0\n  var y = 0\n  var lineHeight = number(opt.lineHeight, font.common.lineHeight)\n  var baseline = font.common.base\n  var descender = lineHeight-baseline\n  var letterSpacing = opt.letterSpacing || 0\n  var height = lineHeight * lines.length - descender\n  var align = getAlignType(this._opt.align)\n\n  //draw text along baseline\n  y -= height\n  \n  //the metrics for this text layout\n  this._width = maxLineWidth\n  this._height = height\n  this._descender = lineHeight - baseline\n  this._baseline = baseline\n  this._xHeight = getXHeight(font)\n  this._capHeight = getCapHeight(font)\n  this._lineHeight = lineHeight\n  this._ascender = lineHeight - descender - this._xHeight\n    \n  //layout each glyph\n  var self = this\n  lines.forEach(function(line, lineIndex) {\n    var start = line.start\n    var end = line.end\n    var lineWidth = line.width\n    var lastGlyph\n    \n    //for each glyph in that line...\n    for (var i=start; i<end; i++) {\n      var id = text.charCodeAt(i)\n      var glyph = self.getGlyph(font, id)\n      if (glyph) {\n        if (lastGlyph) \n          x += getKerning(font, lastGlyph.id, glyph.id)\n\n        var tx = x\n        if (align === ALIGN_CENTER) \n          tx += (maxLineWidth-lineWidth)/2\n        else if (align === ALIGN_RIGHT)\n          tx += (maxLineWidth-lineWidth)\n\n        glyphs.push({\n          position: [tx, y],\n          data: glyph,\n          index: i,\n          line: lineIndex\n        })  \n\n        //move pen forward\n        x += glyph.xadvance + letterSpacing\n        lastGlyph = glyph\n      }\n    }\n\n    //next line down\n    y += lineHeight\n    x = 0\n  })\n  this._linesTotal = lines.length;\n}\n\nTextLayout.prototype._setupSpaceGlyphs = function(font) {\n  //These are fallbacks, when the font doesn't include\n  //' ' or '\\t' glyphs\n  this._fallbackSpaceGlyph = null\n  this._fallbackTabGlyph = null\n\n  if (!font.chars || font.chars.length === 0)\n    return\n\n  //try to get space glyph\n  //then fall back to the 'm' or 'w' glyphs\n  //then fall back to the first glyph available\n  var space = getGlyphById(font, SPACE_ID) \n          || getMGlyph(font) \n          || font.chars[0]\n\n  //and create a fallback for tab\n  var tabWidth = this._opt.tabSize * space.xadvance\n  this._fallbackSpaceGlyph = space\n  this._fallbackTabGlyph = xtend(space, {\n    x: 0, y: 0, xadvance: tabWidth, id: TAB_ID, \n    xoffset: 0, yoffset: 0, width: 0, height: 0\n  })\n}\n\nTextLayout.prototype.getGlyph = function(font, id) {\n  var glyph = getGlyphById(font, id)\n  if (glyph)\n    return glyph\n  else if (id === TAB_ID) \n    return this._fallbackTabGlyph\n  else if (id === SPACE_ID) \n    return this._fallbackSpaceGlyph\n  return null\n}\n\nTextLayout.prototype.computeMetrics = function(text, start, end, width) {\n  var letterSpacing = this._opt.letterSpacing || 0\n  var font = this._opt.font\n  var curPen = 0\n  var curWidth = 0\n  var count = 0\n  var glyph\n  var lastGlyph\n\n  if (!font.chars || font.chars.length === 0) {\n    return {\n      start: start,\n      end: start,\n      width: 0\n    }\n  }\n\n  end = Math.min(text.length, end)\n  for (var i=start; i < end; i++) {\n    var id = text.charCodeAt(i)\n    var glyph = this.getGlyph(font, id)\n\n    if (glyph) {\n      //move pen forward\n      var xoff = glyph.xoffset\n      var kern = lastGlyph ? getKerning(font, lastGlyph.id, glyph.id) : 0\n      curPen += kern\n\n      var nextPen = curPen + glyph.xadvance + letterSpacing\n      var nextWidth = curPen + glyph.width\n\n      //we've hit our limit; we can't move onto the next glyph\n      if (nextWidth >= width || nextPen >= width)\n        break\n\n      //otherwise continue along our line\n      curPen = nextPen\n      curWidth = nextWidth\n      lastGlyph = glyph\n    }\n    count++\n  }\n  \n  //make sure rightmost edge lines up with rendered glyphs\n  if (lastGlyph)\n    curWidth += lastGlyph.xoffset\n\n  return {\n    start: start,\n    end: start + count,\n    width: curWidth\n  }\n}\n\n//getters for the private vars\n;['width', 'height', \n  'descender', 'ascender',\n  'xHeight', 'baseline',\n  'capHeight',\n  'lineHeight' ].forEach(addGetter)\n\nfunction addGetter(name) {\n  Object.defineProperty(TextLayout.prototype, name, {\n    get: wrapper(name),\n    configurable: true\n  })\n}\n\n//create lookups for private vars\nfunction wrapper(name) {\n  return (new Function([\n    'return function '+name+'() {',\n    '  return this._'+name,\n    '}'\n  ].join('\\n')))()\n}\n\nfunction getGlyphById(font, id) {\n  if (!font.chars || font.chars.length === 0)\n    return null\n\n  var glyphIdx = findChar(font.chars, id)\n  if (glyphIdx >= 0)\n    return font.chars[glyphIdx]\n  return null\n}\n\nfunction getXHeight(font) {\n  for (var i=0; i<X_HEIGHTS.length; i++) {\n    var id = X_HEIGHTS[i].charCodeAt(0)\n    var idx = findChar(font.chars, id)\n    if (idx >= 0) \n      return font.chars[idx].height\n  }\n  return 0\n}\n\nfunction getMGlyph(font) {\n  for (var i=0; i<M_WIDTHS.length; i++) {\n    var id = M_WIDTHS[i].charCodeAt(0)\n    var idx = findChar(font.chars, id)\n    if (idx >= 0) \n      return font.chars[idx]\n  }\n  return 0\n}\n\nfunction getCapHeight(font) {\n  for (var i=0; i<CAP_HEIGHTS.length; i++) {\n    var id = CAP_HEIGHTS[i].charCodeAt(0)\n    var idx = findChar(font.chars, id)\n    if (idx >= 0) \n      return font.chars[idx].height\n  }\n  return 0\n}\n\nfunction getKerning(font, left, right) {\n  if (!font.kernings || font.kernings.length === 0)\n    return 0\n\n  var table = font.kernings\n  for (var i=0; i<table.length; i++) {\n    var kern = table[i]\n    if (kern.first === left && kern.second === right)\n      return kern.amount\n  }\n  return 0\n}\n\nfunction getAlignType(align) {\n  if (align === 'center')\n    return ALIGN_CENTER\n  else if (align === 'right')\n    return ALIGN_RIGHT\n  return ALIGN_LEFT\n}\n\nfunction findChar (array, value, start) {\n  start = start || 0\n  for (var i = start; i < array.length; i++) {\n    if (array[i].id === value) {\n      return i\n    }\n  }\n  return -1\n}","var newline = /\\n/\nvar newlineChar = '\\n'\nvar whitespace = /\\s/\n\nmodule.exports = function(text, opt) {\n    var lines = module.exports.lines(text, opt)\n    return lines.map(function(line) {\n        return text.substring(line.start, line.end)\n    }).join('\\n')\n}\n\nmodule.exports.lines = function wordwrap(text, opt) {\n    opt = opt||{}\n\n    //zero width results in nothing visible\n    if (opt.width === 0 && opt.mode !== 'nowrap') \n        return []\n\n    text = text||''\n    var width = typeof opt.width === 'number' ? opt.width : Number.MAX_VALUE\n    var start = Math.max(0, opt.start||0)\n    var end = typeof opt.end === 'number' ? opt.end : text.length\n    var mode = opt.mode\n\n    var measure = opt.measure || monospace\n    if (mode === 'pre')\n        return pre(measure, text, start, end, width)\n    else\n        return greedy(measure, text, start, end, width, mode)\n}\n\nfunction idxOf(text, chr, start, end) {\n    var idx = text.indexOf(chr, start)\n    if (idx === -1 || idx > end)\n        return end\n    return idx\n}\n\nfunction isWhitespace(chr) {\n    return whitespace.test(chr)\n}\n\nfunction pre(measure, text, start, end, width) {\n    var lines = []\n    var lineStart = start\n    for (var i=start; i<end && i<text.length; i++) {\n        var chr = text.charAt(i)\n        var isNewline = newline.test(chr)\n\n        //If we've reached a newline, then step down a line\n        //Or if we've reached the EOF\n        if (isNewline || i===end-1) {\n            var lineEnd = isNewline ? i : i+1\n            var measured = measure(text, lineStart, lineEnd, width)\n            lines.push(measured)\n            \n            lineStart = i+1\n        }\n    }\n    return lines\n}\n\nfunction greedy(measure, text, start, end, width, mode) {\n    //A greedy word wrapper based on LibGDX algorithm\n    //https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g2d/BitmapFontCache.java\n    var lines = []\n\n    var testWidth = width\n    //if 'nowrap' is specified, we only wrap on newline chars\n    if (mode === 'nowrap')\n        testWidth = Number.MAX_VALUE\n\n    while (start < end && start < text.length) {\n        //get next newline position\n        var newLine = idxOf(text, newlineChar, start, end)\n\n        //eat whitespace at start of line\n        while (start < newLine) {\n            if (!isWhitespace( text.charAt(start) ))\n                break\n            start++\n        }\n\n        //determine visible # of glyphs for the available width\n        var measured = measure(text, start, newLine, testWidth)\n\n        var lineEnd = start + (measured.end-measured.start)\n        var nextStart = lineEnd + newlineChar.length\n\n        //if we had to cut the line before the next newline...\n        if (lineEnd < newLine) {\n            //find char to break on\n            while (lineEnd > start) {\n                if (isWhitespace(text.charAt(lineEnd)))\n                    break\n                lineEnd--\n            }\n            if (lineEnd === start) {\n                if (nextStart > start + newlineChar.length) nextStart--\n                lineEnd = nextStart // If no characters to break, show all.\n            } else {\n                nextStart = lineEnd\n                //eat whitespace at end of line\n                while (lineEnd > start) {\n                    if (!isWhitespace(text.charAt(lineEnd - newlineChar.length)))\n                        break\n                    lineEnd--\n                }\n            }\n        }\n        if (lineEnd >= start) {\n            var result = measure(text, start, lineEnd, testWidth)\n            lines.push(result)\n        }\n        start = nextStart\n    }\n    return lines\n}\n\n//determines the visible number of glyphs within a given width\nfunction monospace(text, start, end, width) {\n    var glyphs = Math.min(width, end-start)\n    return {\n        start: start,\n        end: start+glyphs\n    }\n}","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","module.exports = function numtype(num, def) {\n\treturn typeof num === 'number'\n\t\t? num \n\t\t: (typeof def === 'number' ? def : 0)\n}","var dtype = require('dtype')\nvar anArray = require('an-array')\nvar isBuffer = require('is-buffer')\n\nvar CW = [0, 2, 3]\nvar CCW = [2, 1, 3]\n\nmodule.exports = function createQuadElements(array, opt) {\n    //if user didn't specify an output array\n    if (!array || !(anArray(array) || isBuffer(array))) {\n        opt = array || {}\n        array = null\n    }\n\n    if (typeof opt === 'number') //backwards-compatible\n        opt = { count: opt }\n    else\n        opt = opt || {}\n\n    var type = typeof opt.type === 'string' ? opt.type : 'uint16'\n    var count = typeof opt.count === 'number' ? opt.count : 1\n    var start = (opt.start || 0) \n\n    var dir = opt.clockwise !== false ? CW : CCW,\n        a = dir[0], \n        b = dir[1],\n        c = dir[2]\n\n    var numIndices = count * 6\n\n    var indices = array || new (dtype(type))(numIndices)\n    for (var i = 0, j = 0; i < numIndices; i += 6, j += 4) {\n        var x = i + start\n        indices[x + 0] = j + 0\n        indices[x + 1] = j + 1\n        indices[x + 2] = j + 2\n        indices[x + 3] = j + a\n        indices[x + 4] = j + b\n        indices[x + 5] = j + c\n    }\n    return indices\n}","module.exports = function(dtype) {\n  switch (dtype) {\n    case 'int8':\n      return Int8Array\n    case 'int16':\n      return Int16Array\n    case 'int32':\n      return Int32Array\n    case 'uint8':\n      return Uint8Array\n    case 'uint16':\n      return Uint16Array\n    case 'uint32':\n      return Uint32Array\n    case 'float32':\n      return Float32Array\n    case 'float64':\n      return Float64Array\n    case 'array':\n      return Array\n    case 'uint8_clamped':\n      return Uint8ClampedArray\n  }\n}\n","var str = Object.prototype.toString\n\nmodule.exports = anArray\n\nfunction anArray(arr) {\n  return (\n       arr.BYTES_PER_ELEMENT\n    && str.call(arr.buffer) === '[object ArrayBuffer]'\n    || Array.isArray(arr)\n  )\n}\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","import {\n  BufferAttribute,\n  BufferGeometry\n} from 'three';\nimport getNormals from 'polyline-normals';\nimport { distance2 } from '../../math';\n\nexport default class ThreeLineGeometry extends BufferGeometry {\n  pathLength: number = 0;\n\n  constructor(path: Array<number>[], opt: any = {}) {\n    super();\n\n    this.setAttribute('position', new BufferAttribute(new Float32Array(), 3));\n    this.setAttribute('lineNormal', new BufferAttribute(new Float32Array(), 2));\n    this.setAttribute('lineMiter', new BufferAttribute(new Float32Array(), 1));\n    this.setIndex(new BufferAttribute(new Float32Array(), 1));\n    if (opt.distances) {\n      this.setAttribute('lineDistance', new BufferAttribute(new Float32Array(), 2));\n    }\n\n    this.update(path, opt.closed);\n  }\n\n  update(path: Array<number>[], closed: boolean) {\n    const normals = getNormals(path, closed);\n\n    if (closed) {\n      path = path.slice();\n      path.push(path[0]);\n      normals.push(normals[0]);\n    }\n\n    const attrDistance = this.getAttribute('lineDistance');\n\n    let pathLength = 0;\n    let lastPt;\n\n    // Determine path length\n    path.forEach((point: Array<number>) => {\n      if (lastPt !== undefined) {\n        // @ts-ignore\n        pathLength += distance2(point[0], point[1], lastPt[0], lastPt[1]);\n      }\n      // @ts-ignore\n      lastPt = point;\n    });\n\n    this.pathLength = pathLength;\n\n    // Determine normalized position of each vertice along path\n    lastPt = undefined;\n    let pos = 0;\n    let per = 0;\n    const indexArray: Array<number> = [];\n    const positionArray: Array<number> = [];\n    const distanceArray: Array<number> = [];\n\n    const total = path.length;\n    const iTotal = total - 1;\n    let index = 0;\n    for (let i = 0; i < total; ++i) {\n      const point = path[i];\n      if (i < iTotal) {\n        indexArray[i * 6 + 0] = index + 0;\n        indexArray[i * 6 + 1] = index + 1;\n        indexArray[i * 6 + 2] = index + 2;\n        indexArray[i * 6 + 3] = index + 2;\n        indexArray[i * 6 + 4] = index + 1;\n        indexArray[i * 6 + 5] = index + 3;\n        index += 2;\n      }\n\n      let dist = 0;\n      if (lastPt !== undefined) {\n        // @ts-ignore\n        dist = distance2(point[0], point[1], lastPt[0], lastPt[1]);\n      }\n      // @ts-ignore\n      lastPt = point;\n\n      positionArray.push(point[0], point[1], 0);\n      positionArray.push(point[0], point[1], 0);\n\n      if (attrDistance) {\n        pos += dist;\n        per += dist / pathLength;\n        distanceArray.push(pos, pathLength);\n        distanceArray.push(pos, pathLength);\n      }\n    };\n    this.setIndex(indexArray);\n    this.setAttribute('position', new BufferAttribute(new Float32Array(positionArray), 3));\n\n    if (attrDistance) {\n      this.setAttribute('lineDistance', new BufferAttribute(new Float32Array(distanceArray), 2));\n    }\n\n    const normalArray: Array<number> = [];\n    const miterArray: Array<number> = [];\n    normals.forEach((n: Array<number>) => {\n      const norm = n[0];\n      const miter = n[1];\n      normalArray.push(norm[0], norm[1]);\n      normalArray.push(norm[0], norm[1]);\n      miterArray.push(-miter, miter);\n    });\n\n    this.setAttribute('lineNormal', new BufferAttribute(new Float32Array(normalArray), 2));\n    this.setAttribute('lineMiter', new BufferAttribute(new Float32Array(miterArray), 1));\n  }\n\n  static createPath(geometry: any, scalar: boolean): Array<number>[] {\n    const s = scalar ? window.devicePixelRatio : 1;\n    const path: Array<number>[] = [];\n    const total = geometry.length;\n    for (let i = 0; i < total; ++i) {\n      path.push([geometry[i].x * s, geometry[i].y * s]);\n    }\n    return path;\n  }\n}\n","var util = require('polyline-miter-util')\n\nvar lineA = [0, 0]\nvar lineB = [0, 0]\nvar tangent = [0, 0]\nvar miter = [0, 0]\n\nmodule.exports = function(points, closed) {\n    var curNormal = null\n    var out = []\n    if (closed) {\n        points = points.slice()\n        points.push(points[0])\n    }\n\n    var total = points.length\n    for (var i=1; i<total; i++) {\n        var last = points[i-1]\n        var cur = points[i]\n        var next = i<points.length-1 ? points[i+1] : null\n\n        util.direction(lineA, cur, last)\n        if (!curNormal)  {\n            curNormal = [0, 0]\n            util.normal(curNormal, lineA)\n        }\n\n        if (i === 1) //add initial normals\n            addNext(out, curNormal, 1)\n\n        if (!next) { //no miter, simple segment\n            util.normal(curNormal, lineA) //reset normal\n            addNext(out, curNormal, 1)\n        } else { //miter with last\n            //get unit dir of next line\n            util.direction(lineB, next, cur)\n\n            //stores tangent & miter\n            var miterLen = util.computeMiter(tangent, miter, lineA, lineB, 1)\n            addNext(out, miter, miterLen)\n        }\n    }\n\n    //if the polyline is a closed loop, clean up the last normal\n    if (points.length > 2 && closed) {\n        var last2 = points[total-2]\n        var cur2 = points[0]\n        var next2 = points[1]\n\n        util.direction(lineA, cur2, last2)\n        util.direction(lineB, next2, cur2)\n        util.normal(curNormal, lineA)\n        \n        var miterLen2 = util.computeMiter(tangent, miter, lineA, lineB, 1)\n        out[0][0] = miter.slice()\n        out[total-1][0] = miter.slice()\n        out[0][1] = miterLen2\n        out[total-1][1] = miterLen2\n        out.pop()\n    }\n\n    return out\n}\n\nfunction addNext(out, normal, length) {\n    out.push([[normal[0], normal[1]], length])\n}","var add = require('gl-vec2/add')\nvar set = require('gl-vec2/set')\nvar normalize = require('gl-vec2/normalize')\nvar subtract = require('gl-vec2/subtract')\nvar dot = require('gl-vec2/dot')\n\nvar tmp = [0, 0]\n\nmodule.exports.computeMiter = function computeMiter(tangent, miter, lineA, lineB, halfThick) {\n    //get tangent line\n    add(tangent, lineA, lineB)\n    normalize(tangent, tangent)\n\n    //get miter as a unit vector\n    set(miter, -tangent[1], tangent[0])\n    set(tmp, -lineA[1], lineA[0])\n\n    //get the necessary length of our miter\n    return halfThick / dot(miter, tmp)\n}\n\nmodule.exports.normal = function normal(out, dir) {\n    //get perpendicular\n    set(out, -dir[1], dir[0])\n    return out\n}\n\nmodule.exports.direction = function direction(out, a, b) {\n    //get unit dir of two lines\n    subtract(out, a, b)\n    normalize(out, out)\n    return out\n}","module.exports = add\n\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nfunction add(out, a, b) {\n    out[0] = a[0] + b[0]\n    out[1] = a[1] + b[1]\n    return out\n}","module.exports = set\n\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\nfunction set(out, x, y) {\n    out[0] = x\n    out[1] = y\n    return out\n}","module.exports = normalize\n\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a vector to normalize\n * @returns {vec2} out\n */\nfunction normalize(out, a) {\n    var x = a[0],\n        y = a[1]\n    var len = x*x + y*y\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len)\n        out[0] = a[0] * len\n        out[1] = a[1] * len\n    }\n    return out\n}","module.exports = subtract\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nfunction subtract(out, a, b) {\n    out[0] = a[0] - b[0]\n    out[1] = a[1] - b[1]\n    return out\n}","module.exports = dot\n\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {Number} dot product of a and b\n */\nfunction dot(a, b) {\n    return a[0] * b[0] + a[1] * b[1]\n}","import {\n  Color,\n  DoubleSide,\n  ShaderMaterial,\n  Vector3\n} from 'three';\nimport vertex from '../glsl/layers/stroke.vert';\nimport fragment from '../glsl/layers/stroke.frag';\n\nexport default class StrokeMaterial extends ShaderMaterial {\n  constructor(opt: any = {}) {\n    // @ts-ignore\n    const thickness = opt.thickness !== undefined ? opt.thickness : 4.0;\n    // @ts-ignore\n    const opacity = opt.opacity !== undefined ? opt.opacity : 1.0;\n    // @ts-ignore\n    const color = opt.diffuse !== undefined ? opt.diffuse : 0xffffff;\n    // @ts-ignore\n    const dash = opt.dash !== undefined ? opt.dash : new Vector3(0, 10, 0);\n    // @ts-ignore\n    const trim = opt.trim !== undefined ? opt.trim : new Vector3(0, 1, 0);\n    super({\n      uniforms: {\n        thickness: {\n          // @ts-ignore\n          type: 'f',\n          value: thickness\n        },\n        opacity: {\n          // @ts-ignore\n          type: 'f',\n          value: opacity\n        },\n        diffuse: {\n          // @ts-ignore\n          type: 'c',\n          value: new Color(color)\n        },\n        dash: {\n          // @ts-ignore\n          type: 'f',\n          value: dash\n        },\n        trim: {\n          // @ts-ignore\n          type: 'f',\n          value: trim\n        }\n      },\n      vertexShader: vertex,\n      fragmentShader: fragment,\n      // @ts-ignore\n      side: opt.side !== undefined ? opt.side : DoubleSide,\n      // @ts-ignore\n      transparent: opt.transparent !== undefined ? opt.transparent : true\n    });\n  }\n}\n","export default \"#define GLSLIFY 1\\nuniform float thickness;\\nattribute float lineMiter;\\nattribute vec2 lineNormal;\\nattribute vec2 lineDistance; // x = pos, y = total length\\nvarying vec2 lineU;\\n\\nvoid main() {\\n  lineU = lineDistance;\\n  vec3 pointPos = position.xyz + vec3(lineNormal * thickness/2.0 * lineMiter, 0.0);\\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( pointPos, 1.0 );\\n}\";","export default \"#define GLSLIFY 1\\n/**\\n * TODO:\\n * Replace shader with code from this paper:\\n * https://hal.inria.fr/hal-00907326/PDF/paper.pdf\\n */\\n\\nvarying vec2 lineU; // x = pos, y = total length\\n\\nuniform vec3 diffuse;\\nuniform float opacity;\\nuniform vec3 dash; // x = dash,  y = gap, z = offset\\nuniform vec3 trim; // x = start, y = end, z = offset\\n\\nvoid main() {\\n  float opacityMod = 1.0;\\n  float offset = trim.z;\\n  \\n  // Dash\\n  if(dash.x > 0.0 && dash.y > 0.0) {\\n    offset = (dash.z * 0.5) - (trim.z * lineU.y);\\n    float dashEnd = dash.x + dash.y;\\n    float lineUMod = mod(lineU.x + offset, dashEnd);\\n    opacityMod = 1.0 - smoothstep(dash.x, dash.x + 0.01, lineUMod);\\n  }\\n  \\n  // Trim\\n  if(trim.x > 0.0 || trim.y < 1.0) {\\n    offset = trim.z;\\n    float per = lineU.x / lineU.y;\\n    float start = min(trim.x, trim.y) + offset;\\n    float end = max(trim.x, trim.y) + offset;\\n    \\n    if(start == end) {\\n      opacityMod = 0.0;\\n    } else if(end > 1.0) {\\n      if(per > end - 1.0 && per < start) {\\n        opacityMod = 0.0;\\n      }\\n    } else if(start < 0.0) {\\n      if(per > end && per < start + 1.0) {\\n        opacityMod = 0.0;\\n      }\\n    } else if(per < start || per > end) {\\n      opacityMod = 0.0;\\n    }\\n  }\\n  \\n  if(opacityMod == 0.0) {\\n    discard;\\n  }\\n  gl_FragColor = vec4(diffuse, opacity * opacityMod);\\n}\\n\";","import {\n  DoubleSide,\n  RawShaderMaterial,\n  Texture,\n  Vector3\n} from 'three';\nimport vertex from '../glsl/layers/font.vert';\nimport fragment from '../glsl/layers/font.frag';\n\nexport default class TextMaterial extends RawShaderMaterial {\n  constructor(texture: Texture | null) {\n    super({\n      uniforms: {\n        opacity: {\n          // @ts-ignore\n          type: 'f',\n          value: 1\n        },\n        color: {\n          // @ts-ignore\n          type: 'v3',\n          value: new Vector3(1, 1, 1)\n        },\n        map: {\n          // @ts-ignore\n          type: 't',\n          value: texture\n        }\n      },\n      vertexShader: vertex,\n      fragmentShader: fragment,\n      transparent: true,\n      side: DoubleSide,\n    });\n  }\n\n  get color(): Vector3 {\n    return this.uniforms.color.value;\n  }\n\n  get map(): Texture | null {\n    return this.uniforms.map.value;\n  }\n\n  set color(value: Vector3) {\n    this.uniforms.color.value = value;\n  }\n\n  set map(value: Texture | null) {\n    this.uniforms.map.value = value;\n  }\n}\n","export default \"#version 300 es\\n#define GLSLIFY 1\\n\\nin vec2 uv;\\nin vec4 position;\\nuniform mat4 projectionMatrix;\\nuniform mat4 modelViewMatrix;\\nout vec2 vUv;\\n\\nvoid main() {\\n  vUv = uv;\\n  gl_Position = projectionMatrix * modelViewMatrix * position;\\n}\\n\";","export default \"#version 300 es\\n#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives : enable\\n#endif\\n\\nprecision highp float;\\n#define GLSLIFY 1\\nuniform float opacity;\\nuniform vec3 color;\\nuniform sampler2D map;\\nin vec2 vUv;\\nout vec4 fragColor;\\n\\n#define alphaTest 1.0 / 255.0\\n\\nfloat median(float r, float g, float b) {\\n  return max(min(r, g), min(max(r, g), b));\\n}\\n\\nvoid main() {\\n  vec3 img = texture(map, vUv).rgb;\\n  float sigDist = median(img.r, img.g, img.b) - 0.5;\\n  float alpha = clamp(sigDist/fwidth(sigDist) + 0.5, 0.0, 1.0);\\n  fragColor = vec4(color.xyz, alpha * opacity);\\n  if (fragColor.a < alphaTest) discard;\\n}\\n\";","import {\n  Object3D,\n  Mesh,\n  Texture,\n  Vector3,\n} from 'three';\n// eslint-disable-next-line\nimport TextGeometry from '../geometry/TextGeometry';\n// eslint-disable-next-line\nimport TextMaterial from '../materials/TextMaterial';\n// eslint-disable-next-line\nimport { normalize } from '../../math';\n\nexport default class TextMesh extends Object3D {\n  geometry: TextGeometry = new TextGeometry();\n\n  material: TextMaterial = new TextMaterial(null);\n\n  mesh: Mesh;\n\n  container: Object3D = new Object3D();\n\n  options: any = {\n    align: 'left',\n    flipY: true,\n    font: undefined,\n    fontSize: 42,\n    text: '',\n    letterSpacing: 0,\n    width: undefined,\n  };\n\n  constructor() {\n    super();\n\n    this.add(this.container);\n\n    this.mesh = new Mesh(this.geometry, this.material);\n    this.mesh.name = 'txtSprite';\n    this.mesh.rotation.x = Math.PI;\n    this.container.add(this.mesh);\n  }\n\n  update(options: any) {\n    if (options.align !== undefined) this.options.align = options.align;\n    if (options.flipY !== undefined) this.options.flipY = options.flipY;\n    if (options.font !== undefined) this.options.font = options.font;\n    if (options.fontSize !== undefined) this.fontSize = options.fontSize;\n    if (options.text !== undefined) this.options.text = options.text;\n    if (options.letterSpacing !== undefined) this.options.letterSpacing = options.letterSpacing;\n    // this.options.width = options.width;\n    if (options.width !== undefined) this.options.width = options.width;\n    this.geometry.update(this.options);\n\n    const { layout } = this.geometry;\n    this.mesh.position.y = layout.lineHeight - layout.height - 5;\n\n    if (this.options.align === 'center') {\n      this.mesh.position.x = -layout.width / 2;\n    } else if (this.options.align === 'right') {\n      this.mesh.position.x = -layout.width;\n    }\n  }\n\n  private checkToUpdate() {\n    if (this.options.font !== undefined) {\n      this.update(this.options);\n    }\n  }\n\n  get align(): string {\n    return this.options.align;\n  }\n\n  // @ts-ignore\n  get color(): Vector3 {\n    return this.material.color;\n  }\n\n  get fontSize(): number {\n    return this.options.fontSize;\n  }\n\n  get map(): Texture | null {\n    return this.material.map;\n  }\n\n  get letterSpacing(): number {\n    return this.options.letterSpacing;\n  }\n\n  get text(): string {\n    return this.options.text;\n  }\n\n  get width(): number | undefined {\n    return this.options.width;\n  }\n\n  set align(value: string) {\n    this.options.align = value;\n    this.checkToUpdate();\n  }\n\n  // @ts-ignore\n  set color(value: Vector3 | Array<number>) {\n    if (Array.isArray(value)) {\n      this.material.color = new Vector3(value[0], value[1], value[2]);\n    } else {\n      this.material.color = value;\n    }\n  }\n\n  set fontSize(value: number) {\n    this.options.fontSize = value;\n    const scale = normalize(0, 42, value);\n    this.container.scale.setScalar(scale);\n  }\n\n  set map(value: Texture | null) {\n    this.material.map = value;\n  }\n\n  set letterSpacing(value: number) {\n    this.options.letterSpacing = value;\n    this.checkToUpdate();\n  }\n\n  set text(value: string) {\n    this.options.text = value;\n    this.checkToUpdate();\n  }\n\n  set width(value: number | undefined) {\n    this.options.width = value;\n    this.checkToUpdate();\n  }\n}\n","import {\n  MathUtils,\n  Mesh,\n  Object3D,\n  Shape\n} from 'three';\nimport Ease from '../../Ease';\nimport Layer from '../../layers/Layer';\nimport Keyframe from '../../Keyframe';\nimport Timeline from '../../Timeline';\nimport { dispose } from '../utils';\n\nexport default class ThreeLayer extends Layer {\n  mesh: Mesh | Object3D | undefined;\n\n  constructor(json: any, assets: any, timeline: Timeline) {\n    super(json, assets);\n    this.item = new Object3D();\n    this.item.name = `${json.name}Container`;\n  }\n\n  dispose() {\n    dispose(this.item);\n  }\n\n  /**\n   * Animates additional paramaters of the object.\n   * @param object The object to animate.\n   * @param key The key to animate.\n   * @param timeline The Timeline associated to the animation.\n   * @param animation The JSON data.\n   * @param deviceRatio DPR given by the JSON.\n   * @param opt Additional param to add an onUpdate call to.\n   */\n  static animate(\n    object: any,\n    key: string,\n    timeline: Timeline,\n    animation: any,\n    deviceRatio?: number,\n    opt = {}\n  ) {\n    const scale = deviceRatio !== undefined ? deviceRatio : 1;\n    const total = animation.keys.length;\n    for (let i = 0; i < total; ++i) {\n      const frame = animation.keys[i];\n      const from = frame.value;\n      const isArr = Array.isArray(from);\n      const isStr = (typeof from) === 'string';\n      const noScale = isArr || isStr;\n      const target = noScale ? frame.target : frame.target * scale;\n      const keyframe = new Keyframe(object, {\n        delay: frame.start,\n        duration: frame.duration,\n        ease: [frame.x0, frame.y0, frame.x1, frame.y1],\n        type: frame.type,\n        // @ts-ignore\n        onUpdate: opt.onUpdate\n      });\n      keyframe.props.push(key);\n      keyframe.startValues.push(noScale ? from : from * scale);\n      keyframe.endValues.push(target);\n      timeline.pushKeyframe(keyframe);\n    }\n  }\n\n  /**\n   * Animates the transform properties of the object\n   * @param container The `item` object of the ThreeLayer.\n   * @param mesh The `mesh` object of the ThreeLayer.\n   * @param transform The JSON data.\n   * @param timeline The Timeline associated to the animation.\n   */\n  static transform(container: Object3D, mesh: Mesh | Object3D | undefined, transform: any, timeline: Timeline) {\n    const scale = window.devicePixelRatio;\n    const t = transform;\n    const a = (t.anchor.length > 2) ? t.anchor : [t.anchor[0], t.anchor[1], 0];\n    const p = (t.position.length > 2) ? t.position : [t.position[0], t.position[1], 0];\n    const r = (t.rotation.length > 2) ? t.rotation : [t.rotation[0], t.rotation[1], 0];\n    const s = (t.scale.length > 2) ? t.scale : [t.scale[0], t.scale[1], 1];\n\n    container.position.set(p[0] * scale, -p[1] * scale, -p[2] * scale);\n    container.scale.set(s[0], s[1], s[2]);\n    container.rotation.set(MathUtils.degToRad(r[0]), -MathUtils.degToRad(r[1]), -MathUtils.degToRad(r[2]));\n    if (mesh !== undefined) {\n      mesh.position.set(-a[0] * scale, a[1] * scale, a[2] * scale); // anchor\n      // @ts-ignore\n      if (mesh.material !== undefined) {\n        // @ts-ignore\n        mesh.material.opacity = t.opacity;\n      }\n    }\n\n    if (t.timeline === undefined) return;\n\n    const total = t.timeline.length;\n    for (let i = 0; i < total; ++i) {\n      const ani = t.timeline[i];\n      const nTotal = ani.keys.length;\n      const lastN = nTotal - 1;\n      for (let n = 0; n < nTotal; ++n) {\n        const key = ani.keys[n];\n        const { target } = key;\n        const { duration } = key;\n        const { x0 } = key;\n        const { y0 } = key;\n        const { x1 } = key;\n        const { y1 } = key;\n        let keyframe: Keyframe | undefined;\n\n        switch (ani.name) {\n          case 'opacity':\n            // @ts-ignore\n            if (mesh !== undefined && mesh.material !== undefined) {\n              // @ts-ignore\n              keyframe = new Keyframe(mesh.material, {\n                opacity: target,\n                duration: duration,\n                delay: key.start,\n                ease: [x0, y0, x1, y1],\n                type: key.type,\n                start: {\n                  opacity: key.value\n                }\n              });\n            }\n            break;\n\n          case 'anchorX':\n            if (mesh !== undefined) {\n              keyframe = new Keyframe(mesh.position, {\n                x: target * -scale,\n                duration: duration,\n                delay: key.start,\n                ease: [x0, y0, x1, y1],\n                type: key.type,\n                start: {\n                  x: key.value * -scale\n                }\n              });\n            }\n            break;\n          case 'anchorY':\n            if (mesh !== undefined) {\n              keyframe = new Keyframe(mesh.position, {\n                y: target * scale,\n                duration: duration,\n                delay: key.start,\n                ease: [x0, y0, x1, y1],\n                type: key.type,\n                start: {\n                  y: key.value * scale\n                }\n              });\n            }\n            break;\n\n          case 'positionX':\n            keyframe = new Keyframe(container.position, {\n              x: target * scale,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                x: key.value * scale\n              }\n            });\n            break;\n          case 'positionY':\n            keyframe = new Keyframe(container.position, {\n              y: -target * scale,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                y: -key.value * scale\n              }\n            });\n            break;\n          case 'positionZ':\n            keyframe = new Keyframe(container.position, {\n              z: -target * scale,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                z: -key.value * scale\n              }\n            });\n            break;\n\n          case 'rotationX':\n            keyframe = new Keyframe(container.rotation, {\n              x: MathUtils.degToRad(target),\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                x: MathUtils.degToRad(key.value)\n              }\n            });\n            break;\n          case 'rotationY':\n            keyframe = new Keyframe(container.rotation, {\n              y: MathUtils.degToRad(-target),\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                y: MathUtils.degToRad(-key.value)\n              }\n            });\n            break;\n          case 'rotation':\n          case 'rotationZ':\n            keyframe = new Keyframe(container.rotation, {\n              z: MathUtils.degToRad(-target),\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                z: MathUtils.degToRad(-key.value)\n              }\n            });\n            break;\n\n          case 'scaleX':\n            keyframe = new Keyframe(container.scale, {\n              x: target,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                x: key.value\n              }\n            });\n            break;\n          case 'scaleY':\n            keyframe = new Keyframe(container.scale, {\n              y: target,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                y: key.value\n              }\n            });\n            break;\n          case 'scaleZ':\n            keyframe = new Keyframe(container.scale, {\n              z: target,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                z: key.value\n              }\n            });\n            break;\n          default:\n            //\n        }\n\n        if (keyframe !== undefined) {\n          // Add in-between frames to ensure properties are the correct values\n          // incase the user skips around in time\n          if (n === 0 && keyframe.startTime > 0) {\n            const startKeyframe = new Keyframe(keyframe.object, {\n              type: Ease.HOLD,\n              duration: keyframe.startTime\n            });\n            startKeyframe.props = keyframe.props;\n            startKeyframe.startValues = keyframe.startValues;\n            startKeyframe.endValues = keyframe.endValues;\n            timeline.pushKeyframe(startKeyframe);\n          } else if (n === lastN && keyframe.endTime < timeline.duration) {\n            const endKeyframe = new Keyframe(keyframe.object, {\n              type: Ease.HOLD,\n              delay: keyframe.endTime,\n              duration: timeline.duration - keyframe.endTime\n            });\n            endKeyframe.props = keyframe.props;\n            endKeyframe.startValues = keyframe.endValues;\n            endKeyframe.endValues = keyframe.endValues;\n            timeline.pushKeyframe(endKeyframe);\n          }\n          timeline.pushKeyframe(keyframe);\n        }\n      }\n    }\n  }\n\n  /**\n   * Morphs the Shape object\n   * @param shape The shape associated to the morph.\n   * @param path The path JSON data.\n   * @param timeline The Timeline associated to the animation.\n   * @param curved If the item is curved or not.\n   */\n  static morph(shape: Shape, path: any, timeline: Timeline, curved: boolean) {\n  }\n}\n","import {\n  Object3D,\n  Mesh,\n  ShaderChunk,\n  Material,\n  Matrix4,\n  Geometry,\n  BufferGeometry,\n  NormalBlending,\n  CustomBlending,\n  AddEquation,\n  SrcAlphaFactor,\n  OneFactor,\n  OneMinusDstColorFactor,\n  OneMinusSrcAlphaFactor,\n  DstColorFactor,\n} from 'three';\n\nexport function dispose(object: Object3D | Mesh) {\n  while (object.children.length > 0) {\n    dispose(object.children[0]);\n  }\n\n  if (object.parent) object.parent.remove(object);\n  // @ts-ignore\n  if (object.geometry) object.geometry.dispose();\n  // @ts-ignore\n  if (object.material) {\n    // @ts-ignore\n    if (object.material.map) {\n      // @ts-ignore\n      object.material.map.dispose();\n    }\n    // @ts-ignore\n    object.material.dispose();\n  }\n}\n\nexport function parseShader(shader: string, defines: Array<string>, options: Array<string>) {\n  let output = shader;\n  const definitions = `// defines\\n${defines.join('\\n')}`;\n  const opts = `// options\\n${options.join('\\n')}`;\n  output = output.replace('/** DEFINES */', definitions);\n  output = output.replace('/** OPTIONS */', opts);\n\n  // example:\n  // #include <common>\n  // eslint-disable-next-line\n  const includes = output.match(/\\#include\\s?\\<\\s?(\\w+)\\s?\\>/gm);\n  if (includes) {\n    const total = includes.length;\n    for (let i = 0; i < total; ++i) {\n      const n = includes[i];\n      const o = n.substr(10, n.length - 11);\n      const chunk = `// ${o}\\n${ShaderChunk[o]}`;\n      output = output.replace(n, chunk);\n    }\n  }\n\n  return output;\n}\n\nexport function anchorGeometry(\n  geometry: Geometry | BufferGeometry,\n  x: number,\n  y: number,\n  z: number\n) {\n  geometry.applyMatrix4(new Matrix4().makeTranslation(x, -y, -z));\n}\n\nexport function anchorGeometryTL(geometry: Geometry | BufferGeometry) {\n  geometry.computeBoundingBox();\n  const box = geometry.boundingBox;\n  // @ts-ignore\n  const x = (box.max.x - box.min.x) / 2;\n  // @ts-ignore\n  const y = (box.max.y - box.min.y) / 2;\n  anchorGeometry(geometry, x, y, 0);\n}\n\nexport function setBlendNormal(material: Material) {\n  material.blending = NormalBlending;\n  material.blendEquation = AddEquation;\n  material.blendSrc = SrcAlphaFactor;\n  material.blendDst = OneMinusSrcAlphaFactor;\n  material.needsUpdate = true;\n}\n\nexport function setBlendAdd(material: Material) {\n  material.blending = CustomBlending;\n  material.blendEquation = AddEquation;\n  material.blendSrc = SrcAlphaFactor;\n  material.blendDst = OneFactor;\n  material.needsUpdate = true;\n}\n\nexport function setBlendMultiply(material: Material) {\n  material.blending = CustomBlending;\n  material.blendEquation = AddEquation;\n  material.blendSrc = DstColorFactor;\n  material.blendDst = OneMinusSrcAlphaFactor;\n  material.needsUpdate = true;\n}\n\nexport function setBlendScreen(material: Material) {\n  material.blending = CustomBlending;\n  material.blendEquation = AddEquation;\n  material.blendSrc = OneMinusDstColorFactor;\n  material.blendDst = OneFactor;\n  material.needsUpdate = true;\n}\n","import {\n  Texture,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n  DoubleSide\n} from 'three';\nimport Timeline from '../../Timeline';\nimport ThreeLayer from './ThreeLayer';\nimport { fileName } from '../../utils';\nimport { anchorGeometryTL } from '../utils';\n\nexport default class ThreeImage extends ThreeLayer {\n  constructor(json: any, assets: any, timeline: Timeline) {\n    super(json, assets, timeline);\n\n    this.fileID = fileName(json.content.source);\n    const imgWidth = json.content.width;\n    const imgHeight = json.content.height;\n    const texture = assets.textures[this.fileID] as Texture;\n\n    const geometry = new PlaneBufferGeometry(imgWidth, imgHeight, 1, 1);\n    anchorGeometryTL(geometry);\n\n    const material = new MeshBasicMaterial({\n      map: texture,\n      transparent: true,\n      side: DoubleSide\n    });\n\n    this.mesh = new Mesh(geometry, material);\n    this.mesh.name = `${json.name}`;\n    this.item.add(this.mesh);\n\n    ThreeLayer.transform(this.item, this.mesh, json.transform, timeline);\n  }\n}\n","import {\n  Color,\n  DoubleSide,\n  MathUtils,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  Shape,\n  ShapeGeometry,\n} from 'three';\nimport {\n  HALF_PI,\n  TWO_PI\n} from '../../math';\nimport {\n  setBlendAdd,\n  setBlendMultiply,\n  setBlendScreen\n} from '../utils';\nimport Timeline from '../../Timeline';\nimport ThreeLayer from './ThreeLayer';\nimport ThreeLineGeometry from '../geometry/ThreeLineGeometry';\nimport StrokeMaterial from '../materials/StrokeMaterial';\n\nfunction organizeList(list: Array<any>) {\n  const order = ['stroke', 'fill', 'transform', 'trim', 'repeater'];\n  const total = order.length;\n  const nTotal = list.length;\n  const listOrder: Array<string> = [];\n  for (let i = 0; i < total; ++i) {\n    const orderName = order[i];\n    for (let n = 0; n < nTotal; ++n) {\n      const listName = list[n].type;\n      if (orderName === listName) {\n        listOrder.push(list[n]);\n        break;\n      }\n    }\n  }\n  return listOrder;\n}\n\nexport default class ThreeShape extends ThreeLayer {\n  constructor(json: any, assets: any, timeline: Timeline) {\n    super(json, assets, timeline);\n\n    this.mesh = new Object3D();\n    this.item.add(this.mesh);\n\n    // Create shape\n    const s = window.devicePixelRatio;\n    let parent = this.mesh;\n\n    function createShape(content: Array<any>) {\n      const totalC = content.length - 1;\n      for (let i = totalC; i > -1; --i) {\n        const cLayer = content[i];\n        const isShape = cLayer.paths !== undefined && cLayer.paths.length > 0;\n        if (isShape) {\n          // Cycle through the content to find fill, stroke, and transform\n          let geometry;\n          let mesh;\n          let fill;\n          let stroke;\n          let trim;\n          let repeater;\n          let closed = true;\n          let transform = {\n            opacity: 1,\n            anchor: [0, 0, 0],\n            position: [0, 0, 0],\n            rotation: [0, 0, 0],\n            scale: [1, 1, 1],\n            timeline: []\n          };\n          let nTotal = cLayer.content.length;\n          const data = organizeList(cLayer.content);\n          for (let n = 0; n < nTotal; ++n) {\n            const nLayer = data[n] as any;\n            switch (nLayer.type) {\n              case 'fill':\n                fill = {\n                  alpha: nLayer.value.opacity,\n                  blend: nLayer.value.blend,\n                  color: nLayer.value.color,\n                  timeline: nLayer.timeline[0]\n                };\n                break;\n\n              case 'stroke':\n                stroke = {\n                  alpha: nLayer.value.opacity,\n                  blend: nLayer.value.blend,\n                  color: nLayer.value.color,\n                  width: nLayer.value.width * s,\n                  dashes: nLayer.value.dashes,\n                  // timeline: nLayer.timeline[0]\n                  timeline: nLayer.timeline\n                };\n                break;\n\n              default:\n              case 'transform':\n                // @ts-ignore\n                transform = nLayer;\n                break;\n\n              case 'trim':\n                trim = nLayer;\n                break;\n\n              case 'repeater':\n                repeater = nLayer;\n                break;\n            }\n          }\n\n          /**\n           * Create Material / material effectors\n           */\n\n          /**\n           * Draw Shapes\n           */\n\n          const shape = new Shape();\n\n          // Draw paths\n          nTotal = cLayer.paths.length;\n          for (let n = 0; n < nTotal; ++n) {\n            let x;\n            let y;\n            let w;\n            let h;\n            let t;\n            let u;\n            let angle;\n            let curved;\n            let totalPoints;\n            const path = cLayer.paths[n];\n            closed = true;\n            switch (path.type) {\n              case 'ellipse':\n                x = path.x * s;\n                y = path.y * s;\n                w = (path.width / 2) * s;\n                h = (path.height / 2) * s;\n                shape.ellipse(x, y, w, h, 0, TWO_PI, true, Math.PI / 2);\n                break;\n\n              default:\n              case 'rectangle':\n                x = (path.x - (path.width / 2)) * s;\n                y = (-path.y - (path.height / 2)) * s;\n                w = path.width * s;\n                h = path.height * s;\n                shape.moveTo(x + w, y + h);\n                shape.lineTo(x + w, y);\n                shape.lineTo(x, y);\n                shape.lineTo(x, y + h);\n                break;\n\n              case 'polygon':\n                totalPoints = path.points;\n                w = path.radius * s;\n                angle = HALF_PI; // 90 degrees\n                shape.moveTo(\n                  Math.cos(angle) * w,\n                  Math.sin(angle) * w\n                );\n                for (t = 1; t < path.points + 1; ++t) {\n                  angle = -(t / totalPoints) * TWO_PI + HALF_PI; // 90 degrees\n                  shape.lineTo(\n                    Math.cos(angle) * w,\n                    Math.sin(angle) * w\n                  );\n                }\n                break;\n\n              case 'polystar':\n                totalPoints = path.points * 2;\n                w = path.outRadius * s;\n                h = path.inRadius * s;\n                angle = MathUtils.degToRad(path.rotation) + HALF_PI; // 90 degrees\n                shape.moveTo(\n                  Math.cos(angle) * w,\n                  Math.sin(angle) * w\n                );\n\n                angle = (1 / totalPoints) * TWO_PI + MathUtils.degToRad(path.rotation) + HALF_PI; // 90 degrees\n                shape.lineTo(\n                  Math.cos(angle) * h,\n                  Math.sin(angle) * h\n                );\n\n                for (t = 1; t < path.points; ++t) {\n                  angle = ((t * 2) / totalPoints) * TWO_PI\n                    + MathUtils.degToRad(path.rotation) + HALF_PI; // 90 degrees\n                  shape.lineTo(\n                    Math.cos(angle) * w,\n                    Math.sin(angle) * w\n                  );\n\n                  angle = ((t * 2 + 1) / totalPoints) * TWO_PI\n                    + MathUtils.degToRad(path.rotation) + HALF_PI; // 90 degrees\n                  shape.lineTo(\n                    Math.cos(angle) * h,\n                    Math.sin(angle) * h\n                  );\n                }\n                break;\n\n              case 'shape':\n                totalPoints = path.vertices.length;\n                curved = false;\n                closed = path.closed;\n                shape.moveTo(path.vertices[0][0] * s, path.vertices[0][1] * -s);\n                for (u = 0; u < totalPoints; ++u) {\n                  if (path.inTangents[u][0] !== 0\n                    || path.inTangents[u][1] !== 0\n                    || path.outTangents[u][0] !== 0\n                    || path.outTangents[u][1] !== 0) {\n                    curved = true;\n                    break;\n                  }\n                }\n\n                if (curved) {\n                  for (u = 0; u < totalPoints; ++u) {\n                    t = u + 1;\n                    if (path.closed) t %= totalPoints;\n                    else if (t >= totalPoints) break;\n                    shape.bezierCurveTo(\n                      (path.vertices[u][0] + path.outTangents[u][0]) * s,\n                      (path.vertices[u][1] + path.outTangents[u][1]) * -s,\n                      (path.vertices[t][0] + path.inTangents[t][0]) * s,\n                      (path.vertices[t][1] + path.inTangents[t][1]) * -s,\n                      (path.vertices[t][0]) * s,\n                      path.vertices[t][1] * -s\n                    );\n                  }\n                } else {\n                  for (u = 0; u < totalPoints; ++u) {\n                    t = u + 1;\n                    if (path.closed) t %= totalPoints;\n                    else if (t >= totalPoints) {\n                      break;\n                    }\n                    shape.lineTo(\n                      path.vertices[t][0] * s,\n                      path.vertices[t][1] * -s\n                    );\n                  }\n                }\n                ThreeLayer.morph(shape, path, timeline, curved);\n                break;\n            }\n          }\n\n          /**\n           * Create Mesh for shape\n           */\n\n          const container = new Object3D();\n          parent.add(container);\n\n          if (fill !== undefined) {\n            const fillColor = new Color(fill.color[0], fill.color[1], fill.color[2]);\n            const fillMaterial = new MeshBasicMaterial({\n              color: fillColor,\n              opacity: fill.alpha,\n              side: DoubleSide,\n              transparent: true,\n              depthTest: false\n            });\n            geometry = new ShapeGeometry(shape);\n            mesh = new Mesh(geometry, fillMaterial);\n            ThreeLayer.transform(container, mesh, transform, timeline);\n            container.add(mesh);\n\n            if (fill.blend === 'screen') {\n              setBlendScreen(fillMaterial);\n            } else if (fill.blend === 'linearDodge') {\n              setBlendAdd(fillMaterial);\n            } else if (fill.blend === 'multiply') {\n              setBlendMultiply(fillMaterial);\n            }\n\n            fillMaterial.opacity = fill.alpha;\n\n            if (fill.timeline !== undefined) {\n              const aniFill = {\n                color: [fillColor.r, fillColor.g, fillColor.b, 1],\n                onUpdate: () => {\n                  fillMaterial.color.r = aniFill.color[0];\n                  fillMaterial.color.g = aniFill.color[1];\n                  fillMaterial.color.b = aniFill.color[2];\n                }\n              };\n              ThreeLayer.animate(aniFill, 'color', timeline, fill.timeline, 1, {\n                onUpdate: aniFill.onUpdate\n              });\n            }\n          }\n\n          if (stroke !== undefined) {\n            const strokeColor = new Color(stroke.color[0], stroke.color[1], stroke.color[2]);\n            const strokeMaterial = new StrokeMaterial({\n              diffuse: strokeColor.getHex(),\n              opacity: stroke.alpha,\n              thickness: stroke.width\n            });\n\n            /**\n             * Animate multiple properties\n             */\n            if (stroke.timeline !== undefined) {\n              stroke.timeline.forEach((strokeTimeline: any) => {\n                if (strokeTimeline.name === 'stroke') {\n                  const aniStroke = {\n                    color: [strokeColor.r, strokeColor.g, strokeColor.b, 1],\n                    onUpdate: () => {\n                      strokeMaterial.uniforms.diffuse.value.r = aniStroke.color[0];\n                      strokeMaterial.uniforms.diffuse.value.g = aniStroke.color[1];\n                      strokeMaterial.uniforms.diffuse.value.b = aniStroke.color[2];\n                    }\n                  };\n                  ThreeLayer.animate(aniStroke, 'color', timeline, strokeTimeline, 1, {\n                    onUpdate: aniStroke.onUpdate\n                  });\n                } else if (strokeTimeline.name === 'opacity') {\n                  ThreeLayer.animate(strokeMaterial.uniforms.opacity, 'value', timeline, strokeTimeline, 1);\n                } else if (strokeTimeline.name === 'width') {\n                  ThreeLayer.animate(strokeMaterial.uniforms.thickness, 'value', timeline, strokeTimeline, s);\n                }\n              });\n            }\n\n            /**\n             * Dashes\n             */\n            if (stroke.dashes !== undefined) {\n              strokeMaterial.uniforms.dash.value.x = stroke.dashes.dash * s;\n              strokeMaterial.uniforms.dash.value.y = stroke.dashes.gap * s;\n              strokeMaterial.uniforms.dash.value.z = stroke.dashes.offset * s;\n\n              // Animation\n              if (stroke.dashes.timeline !== undefined) {\n                nTotal = stroke.dashes.timeline.length;\n                for (let n = 0; n < nTotal; ++n) {\n                  switch (stroke.dashes.timeline[n].name) {\n                    default:\n                    case 'dash':\n                      ThreeLayer.animate(\n                        strokeMaterial.uniforms.dash.value,\n                        'x',\n                        timeline,\n                        stroke.dashes.timeline[n],\n                        s\n                      );\n                      break;\n                    case 'gap':\n                      ThreeLayer.animate(\n                        strokeMaterial.uniforms.dash.value,\n                        'y',\n                        timeline,\n                        stroke.dashes.timeline[n],\n                        s\n                      );\n                      break;\n                    case 'offset':\n                      ThreeLayer.animate(\n                        strokeMaterial.uniforms.dash.value,\n                        'z',\n                        timeline,\n                        stroke.dashes.timeline[n],\n                        s\n                      );\n                      break;\n                  }\n                }\n              }\n            }\n\n            /**\n             * Trim\n             */\n            if (trim !== undefined) {\n              strokeMaterial.uniforms.trim.value.x = trim.value.start;\n              strokeMaterial.uniforms.trim.value.y = trim.value.end;\n              strokeMaterial.uniforms.trim.value.z = trim.value.offset;\n\n              // Animation\n              nTotal = trim.timeline.length;\n              for (let n = 0; n < nTotal; ++n) {\n                switch (trim.timeline[n].name) {\n                  default:\n                  case 'start':\n                    ThreeLayer.animate(strokeMaterial.uniforms.trim.value, 'x', timeline, trim.timeline[n]);\n                    break;\n                  case 'end':\n                    ThreeLayer.animate(strokeMaterial.uniforms.trim.value, 'y', timeline, trim.timeline[n]);\n                    break;\n                  case 'offset':\n                    ThreeLayer.animate(strokeMaterial.uniforms.trim.value, 'z', timeline, trim.timeline[n]);\n                    break;\n                }\n              }\n            }\n\n            const geomPoints = shape.getPoints(36);\n            const pts = ThreeLineGeometry.createPath(geomPoints, false);\n            geometry = new ThreeLineGeometry(pts, {\n              closed: closed,\n              // distances: stroke.dashes !== undefined || trim !== undefined\n              distances: true\n            });\n\n            mesh = new Mesh(geometry, strokeMaterial);\n            ThreeLayer.transform(container, mesh, transform, timeline);\n            container.add(mesh);\n          }\n        } else {\n          const group = new Object3D();\n          group.name = cLayer.name;\n          parent.add(group);\n          parent = group;\n          if (cLayer.content !== undefined) {\n            createShape(cLayer.content);\n          }\n        }\n      }\n    }\n\n    createShape(json.content);\n    ThreeLayer.transform(this.item, this.mesh, json.transform, timeline);\n  }\n}\n","import {\n  Texture,\n  Vector3,\n} from 'three';\nimport Timeline from '../../Timeline';\nimport ThreeLayer from './ThreeLayer';\nimport TextMesh from '../mesh/TextMesh';\n\nexport default class ThreeText extends ThreeLayer {\n  constructor(json: any, assets: any, timeline: Timeline) {\n    super(json, assets, timeline);\n\n    const { content } = json;\n    const { font } = content;\n    const txtJSON = assets.json[font];\n    const txtTexture = assets.textures[font] as Texture;\n    const fontSize = content.fontSize * window.devicePixelRatio;\n    const txt = new TextMesh();\n    txt.name = `${this.name}Mesh`;\n    txt.color.set(content.color[0], content.color[1], content.color[2]);\n    txt.map = txtTexture;\n    txt.update({\n      align: content.align,\n      font: txtJSON,\n      fontSize: fontSize,\n      text: content.text,\n      letterSpacing: content.spacing\n    });\n    this.mesh = txt;\n    this.item.add(this.mesh);\n\n    ThreeLayer.transform(this.item, this.mesh, json.transform, timeline);\n\n    json.content.timeline.forEach((ani: any) => {\n      if (ani.name === 'text') {\n        ThreeLayer.animate(this, 'text', timeline, ani);\n      } else if (ani.name === 'color') {\n        ThreeLayer.animate(this, 'color', timeline, ani);\n      }\n    });\n  }\n\n  update(time?: number, duration?: number) {\n    // Update material's uniforms\n    const mesh = this.mesh as TextMesh;\n    mesh.material.uniforms.opacity.value = mesh.material.opacity;\n\n    super.update(time, duration);\n  }\n\n  // Getters\n\n  get color(): Vector3 {\n    const mesh = this.mesh as TextMesh;\n    return mesh.color;\n  }\n\n  get text(): string {\n    const mesh = this.mesh as TextMesh;\n    return mesh.text;\n  }\n\n  // Setters\n\n  set color(value: Vector3) {\n    const mesh = this.mesh as TextMesh;\n    mesh.color = value;\n  }\n\n  set text(value: string) {\n    const mesh = this.mesh as TextMesh;\n    mesh.text = value;\n  }\n}\n","import {\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n  DoubleSide,\n  VideoTexture\n} from 'three';\nimport Timeline from '../../Timeline';\nimport ThreeLayer from './ThreeLayer';\nimport { fileName } from '../../utils';\nimport { anchorGeometryTL } from '../utils';\n\nexport default class ThreeVideo extends ThreeLayer {\n  constructor(json: any, assets: any, timeline: Timeline) {\n    super(json, assets, timeline);\n\n    this.fileID = fileName(json.content.source);\n    const imgWidth = json.content.width;\n    const imgHeight = json.content.height;\n    const texture = assets.textures[this.fileID] as VideoTexture;\n    this.file = texture.image;\n    if (!json.content.audioEnabled) {\n      this.file.setAttribute('muted', 'true');\n      this.file.muted = false;\n      this.file.volume = 0;\n    }\n\n    const geometry = new PlaneBufferGeometry(imgWidth, imgHeight, 1, 1);\n    anchorGeometryTL(geometry);\n\n    const material = new MeshBasicMaterial({\n      map: texture,\n      transparent: true,\n      side: DoubleSide\n    });\n\n    this.mesh = new Mesh(geometry, material);\n    this.mesh.name = `${json.name}`;\n    this.item.add(this.mesh);\n\n    ThreeLayer.transform(this.item, this.mesh, json.transform, timeline);\n  }\n\n  dispose() {\n    this.file.pause();\n  }\n\n  update(time: number, duration: number) {\n    if (this.file.paused) {\n      if (time !== undefined) this.file.currentTime = time;\n      this.file.play();\n    }\n    // @ts-ignore\n    this.mesh.material.map.needsUpdate = true;\n  }\n}\n","import {\n  Clock,\n  MathUtils,\n  PerspectiveCamera,\n  Scene,\n  WebGLRenderer,\n} from 'three';\nimport Composition from '../../layers/Composition';\nimport Ease from '../../Ease';\nimport Keyframe from '../../Keyframe';\nimport Layer from '../../layers/Layer';\nimport ThreeImage from './ThreeImage';\nimport ThreeShape from './ThreeShape';\nimport ThreeText from './ThreeText';\nimport ThreeVideo from './ThreeVideo';\nimport { dispose } from '../utils';\n\nexport default class ThreeComposition extends Composition {\n  /**\n   * The ThreeJS Renderer\n   */\n  renderer: WebGLRenderer;\n\n  /**\n   * The ThreeJS Scene\n   */\n  scene: Scene = new Scene();\n\n  /**\n   * The ThreeJS Camera (defaults to a PerspectiveCamera)\n   */\n  camera: PerspectiveCamera = new PerspectiveCamera(60, 1920 / 1080, 1, 2000);\n\n  /**\n   * A ThreeJS Clock\n   */\n  clock: Clock = new Clock();\n\n  /**\n   * If the camera should adjust the FOV to keep items at 0 z-position in focus.\n   */\n  autoFOV: boolean = false;\n\n  /**\n   * Maps effect names to the effect for easy updating.\n   */\n  effects = new Map();\n\n  constructor(renderer: WebGLRenderer, json: any, assets: any) {\n    super(json, assets);\n    this.renderer = renderer;\n    this.resize(window.innerWidth, window.innerHeight);\n  }\n\n  dispose() {\n    dispose(this.scene);\n    super.dispose();\n  }\n\n  play() {\n    super.play();\n    this.clock.start();\n  }\n\n  pause() {\n    this.clock.stop();\n    super.pause();\n  }\n\n  buildCamera(item: any) {\n    this.camera.name = item.name;\n    this.camera.fov = item.content.fov;\n    this.camera.updateProjectionMatrix();\n\n    const scale = window.devicePixelRatio;\n    const t = item.transform;\n    const p = (t.position.length > 2) ? t.position : [t.position[0], t.position[1], 0];\n    const r = (t.rotation.length > 2) ? t.rotation : [t.rotation[0], t.rotation[1], 0];\n\n    this.camera.position.set(p[0] * scale, -p[1] * scale, -p[2] * scale);\n    this.camera.rotation.set(MathUtils.degToRad(r[0]), -MathUtils.degToRad(r[1]), -MathUtils.degToRad(r[2]));\n\n    if (t.timeline === undefined) return;\n\n    const total = t.timeline.length;\n    for (let i = 0; i < total; ++i) {\n      const ani = t.timeline[i];\n      const nTotal = ani.keys.length;\n      const lastN = nTotal - 1;\n      for (let n = 0; n < nTotal; ++n) {\n        const key = ani.keys[n];\n        const { target } = key;\n        const { duration } = key;\n        const { x0 } = key;\n        const { y0 } = key;\n        const { x1 } = key;\n        const { y1 } = key;\n        let keyframe: Keyframe | undefined;\n\n        switch (ani.name) {\n          case 'positionX':\n            keyframe = new Keyframe(this.camera.position, {\n              x: target * scale,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                x: key.value * scale\n              }\n            });\n            break;\n          case 'positionY':\n            keyframe = new Keyframe(this.camera.position, {\n              y: -target * scale,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                y: -key.value * scale\n              }\n            });\n            break;\n          case 'positionZ':\n            keyframe = new Keyframe(this.camera.position, {\n              z: -target * scale,\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                z: -key.value * scale\n              }\n            });\n            break;\n\n          case 'rotationX':\n            keyframe = new Keyframe(this.camera.rotation, {\n              x: MathUtils.degToRad(target),\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                x: MathUtils.degToRad(key.value)\n              }\n            });\n            break;\n          case 'rotationY':\n            keyframe = new Keyframe(this.camera.rotation, {\n              y: MathUtils.degToRad(-target),\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                y: MathUtils.degToRad(-key.value)\n              }\n            });\n            break;\n          case 'rotation':\n          case 'rotationZ':\n            keyframe = new Keyframe(this.camera.rotation, {\n              z: MathUtils.degToRad(-target),\n              duration: duration,\n              delay: key.start,\n              ease: [x0, y0, x1, y1],\n              type: key.type,\n              start: {\n                z: MathUtils.degToRad(-key.value)\n              }\n            });\n            break;\n          default:\n            //\n        }\n\n        if (keyframe !== undefined) {\n          // Add in-between frames to ensure properties are the correct values\n          // incase the user skips around in time\n          if (n === 0 && keyframe.startTime > 0) {\n            const startKeyframe = new Keyframe(keyframe.object, {\n              type: Ease.HOLD,\n              duration: keyframe.startTime\n            });\n            startKeyframe.props = keyframe.props;\n            startKeyframe.startValues = keyframe.startValues;\n            startKeyframe.endValues = keyframe.endValues;\n            this.timeline.pushKeyframe(startKeyframe);\n          } else if (n === lastN && keyframe.endTime < this.timeline.duration) {\n            const endKeyframe = new Keyframe(keyframe.object, {\n              type: Ease.HOLD,\n              delay: keyframe.endTime,\n              duration: this.timeline.duration - keyframe.endTime\n            });\n            endKeyframe.props = keyframe.props;\n            endKeyframe.startValues = keyframe.endValues;\n            endKeyframe.endValues = keyframe.endValues;\n            this.timeline.pushKeyframe(endKeyframe);\n          }\n          this.timeline.pushKeyframe(keyframe);\n        }\n      }\n    }\n  }\n\n  buildLayerImage(json: any, item: any, assets: any): Layer {\n    const layer = new ThreeImage(item, assets, this.timeline);\n    this.scene.add(layer.item);\n    return layer;\n  }\n\n  buildLayerShape(json: any, item: any, assets: any) {\n    const layer = new ThreeShape(item, assets, this.timeline);\n    this.scene.add(layer.item);\n    return layer;\n  }\n\n  buildLayerText(json: any, item: any, assets: any): Layer {\n    const layer = new ThreeText(item, assets, this.timeline);\n    this.scene.add(layer.item);\n    return layer;\n  }\n\n  buildLayerVideo(json: any, item: any, assets: any): Layer {\n    const layer = new ThreeVideo(item, assets, this.timeline);\n    this.scene.add(layer.item);\n    return layer;\n  }\n\n  buildPost(json: any) {\n    //\n  }\n\n  update(time?: number, duration?: number) {\n    super.update(time, duration);\n\n    if (this.autoFOV) {\n      const width = window.innerWidth;\n      const height = window.innerHeight;\n      const aspect = width / height;\n      const dist = this.camera.position.z;\n      const fov = 2 * Math.atan(width / aspect / (2 * dist)) * (180 / Math.PI);\n      this.camera.fov = fov;\n      this.camera.updateProjectionMatrix();\n    }\n  }\n\n  updateLayers(time: number, duration: number) {\n    const total = this.layers.length;\n    for (let i = 0; i < total; ++i) {\n      const l = this.layers[i];\n      const visible = l.showable(time);\n      if (visible) {\n        if (l instanceof Composition) {\n          if (!l.showing) {\n            l.play();\n          }\n          l.update(time, duration);\n        } else {\n          l.update(time, duration);\n        }\n      } else if (l.showing && l instanceof Composition) {\n        if (l.timeline.playing && l.timeline.seconds > 0) {\n          l.timeline.seconds = l.timeline.duration;\n\n          if (l.timeline.speed < 0) {\n            l.timeline.seconds = 0;\n          }\n        }\n      }\n      l.showing = visible;\n      if (l.item !== undefined) {\n        l.item.visible = visible;\n      }\n    }\n  }\n\n  draw() {\n    super.draw();\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  resize(width: number, height: number) {\n    super.resize(width, height);\n\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n\n    this.renderer.setSize(width, height);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(0);\n__webpack_require__(1);\n__webpack_require__(2);\n__webpack_require__(3);\n__webpack_require__(6);\n__webpack_require__(7);\n__webpack_require__(8);\n__webpack_require__(9);\n__webpack_require__(10);\n__webpack_require__(11);\n__webpack_require__(12);\n__webpack_require__(13);\n__webpack_require__(14);\n__webpack_require__(24);\n__webpack_require__(32);\n__webpack_require__(35);\n__webpack_require__(38);\n__webpack_require__(39);\n__webpack_require__(41);\n__webpack_require__(42);\n__webpack_require__(43);\n__webpack_require__(44);\nvar __webpack_exports__ = __webpack_require__(45);\n"],"sourceRoot":""}